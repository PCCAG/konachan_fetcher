2023-04-14 12:59:49.865 | SUCCESS  | cellfunctions_:get_headers:54 - get cookie success..
2023-04-14 13:00:02.078 | SUCCESS  | __main__:mode_a:275 - 单次下载数量:5
2023-04-14 13:00:02.079 | SUCCESS  | __main__:mode_a:276 - 等待时间:1 并发数:12
2023-04-14 13:00:02.080 | SUCCESS  | __main__:mode_a:277 - 下载图片路径:F:\database_learn\k_spider\pictures7
2023-04-14 13:00:02.081 | INFO     | __main__:link_db:139 - 连接数据库中...........
2023-04-14 13:00:02.157 | SUCCESS  | __main__:link_db:159 - 图像数据表: kimg
2023-04-14 13:00:02.158 | SUCCESS  | __main__:link_db:160 - tag数据表: tags
2023-04-14 13:00:02.159 | SUCCESS  | __main__:link_db:162 - link dbas 准备导入数据.....
2023-04-14 13:00:02.337 | INFO     | __main__:mode_a:292 - 数据库共有28807条图像数据
2023-04-14 13:00:02.346 | INFO     | __main__:mode_a:319 - 排除2个重复pid....
2023-04-14 13:00:37.892 | SUCCESS  | cellfunctions_:get_source:109 - 获取源码成功
2023-04-14 13:00:39.354 | SUCCESS  | cellfunctions_:get_source:109 - 获取源码成功
2023-04-14 13:00:41.775 | SUCCESS  | cellfunctions_:get_source:109 - 获取源码成功
2023-04-14 13:00:47.276 | SUCCESS  | cellfunctions_:save_img:189 - 下载图片成功
2023-04-14 13:00:47.511 | SUCCESS  | cellfunctions_:save_img:189 - 下载图片成功
2023-04-14 13:00:51.064 | SUCCESS  | cellfunctions_:save_img:189 - 下载图片成功
2023-04-14 13:00:51.065 | SUCCESS  | __main__:download_imgs:125 - downloaded 3 img ......
2023-04-14 13:00:51.077 | SUCCESS  | __main__:save_img_and_todb:217 - imported: F:\database_learn\k_spider\pictures7\309653.jpg
2023-04-14 13:00:51.083 | SUCCESS  | __main__:save_img_and_todb:217 - imported: F:\database_learn\k_spider\pictures7\304113.jpg
2023-04-14 13:00:51.086 | SUCCESS  | __main__:save_img_and_todb:217 - imported: F:\database_learn\k_spider\pictures7\342262.jpg
2023-04-14 13:00:52.213 | ERROR    | __main__:mode_a:321 - An error has been caught in function 'mode_a', process 'MainProcess' (5548), thread 'MainThread' (14808):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 732, in _read_bytes
    data = self._rfile.read(num_bytes)
           │    │           └ 4
           │    └ None
           └ <pymysql.connections.Connection object at 0x000002930B935E70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\socket.py", line 705, in readinto
    return self._sock.recv_into(b)
           │    │               └ <memory at 0x000002930BB59480>
           │    └ None
           └ <socket.SocketIO object at 0x000002930B935FF0>

ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1089, in _commit_impl
    self.engine.dialect.do_commit(self.connection)
    │    │      │       │         │    └ <property object at 0x0000029371759EE0>
    │    │      │       │         └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>
    │    │      │       └ <function DefaultDialect.do_commit at 0x00000293717BACB0>
    │    │      └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000002930B94E5C0>
    │    └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
    └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 686, in do_commit
    dbapi_connection.commit()
    └ <sqlalchemy.pool.base._ConnectionFairy object at 0x000002930B935F60>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 470, in commit
    self._read_ok_packet()
    │    └ <function Connection._read_ok_packet at 0x000002930BB6DEA0>
    └ <pymysql.connections.Connection object at 0x000002930B935E70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 443, in _read_ok_packet
    pkt = self._read_packet()
          │    └ <function Connection._read_packet at 0x000002930BB6E9E0>
          └ <pymysql.connections.Connection object at 0x000002930B935E70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 692, in _read_packet
    packet_header = self._read_bytes(4)
                    │    └ <function Connection._read_bytes at 0x000002930BB6EA70>
                    └ <pymysql.connections.Connection object at 0x000002930B935E70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 738, in _read_bytes
    raise err.OperationalError(
          │   └ <class 'pymysql.err.OperationalError'>
          └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query ([WinError 10054] 远程主机强迫关闭了一个现有的连接。)')


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab\main_v1.8.py", line 334, in <module>
    mode_a()
    └ <function mode_a at 0x000002930B8F1900>

> File "f:\k_grab\main_v1.8.py", line 321, in mode_a
    save_img_and_todb(pids,wait_time,sem_times,engine,kimg_table,tags_table)
    │                 │    │         │         │      │          └ 'tags'
    │                 │    │         │         │      └ 'kimg'
    │                 │    │         │         └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>
    │                 │    │         └ 12
    │                 │    └ 1
    │                 └ [304113, 309653, 342262]
    └ <function save_img_and_todb at 0x000002930B8F3880>

  File "f:\k_grab\main_v1.8.py", line 230, in save_img_and_todb
    df_tags.to_sql(tags_table,engine,if_exists="append",index=False)
    │       │      │          └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>
    │       │      └ 'tags'
    │       └ <function NDFrame.to_sql at 0x00000293092B0F70>
    └                                             tag
      0                                     aqua_hair
      1                            ...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\core\generic.py", line 2987, in to_sql
    return sql.to_sql(
           │   └ <function to_sql at 0x000002930A622830>
           └ <module 'pandas.io.sql' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pandas\\io\\sql....

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
           │          └ <function SQLDatabase.to_sql at 0x000002930A623C70>
           └ <pandas.io.sql.SQLDatabase object at 0x000002930B934A00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
                     │          └ <function SQLAlchemyEngine.insert_records at 0x000002930A623640>
                     └ <pandas.io.sql.SQLAlchemyEngine object at 0x000002930C2B1C00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1335, in insert_records
    raise err

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           │     │                │                 └ None
           │     │                └ None
           │     └ <function SQLTable.insert at 0x000002930A622EF0>
           └ <pandas.io.sql.SQLTable object at 0x000002930C2B3EB0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   │           │     │     └ <zip object at 0x000002930AA48EC0>
                   │           │     └ ['tag']
                   │           └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>
                   └ <bound method SQLTable._execute_insert of <pandas.io.sql.SQLTable object at 0x000002930C2B3EB0>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             │    │       │    │     │         └ [{'tag': 'aqua_hair'}, {'tag': 'realistic'}, {'tag': 'idolmaster_cinderella_girls_starlight_stage'}, {'tag': 'cat_smile'}, {'...
             │    │       │    │     └ <function TableClause.insert at 0x0000029371696290>
             │    │       │    └ Table('tags', MetaData(), Column('tag', Text(), table=<tags>), schema=None)
             │    │       └ <pandas.io.sql.SQLTable object at 0x000002930C2B3EB0>
             │    └ <function Connection.execute at 0x0000029371775900>
             └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           │    │     │            │       └ immutabledict({})
           │    │     │            └ {}
           │    │     └ ([{'tag': 'aqua_hair'}, {'tag': 'realistic'}, {'tag': 'idolmaster_cinderella_girls_starlight_stage'}, {'tag': 'cat_smile'}, {...
           │    └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000002930B8C9270>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000029371775BD0>
           └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000029371775EA0>
          └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000029371776050>
    └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2128, in _handle_dbapi_exception
    util.raise_(exc_info[1], with_traceback=exc_info[2])
    │    │      │                           └ (<class 'sqlalchemy.exc.OperationalError'>, OperationalError("(pymysql.err.OperationalError) (2013, 'Lost connection to MySQL...
    │    │      └ (<class 'sqlalchemy.exc.OperationalError'>, OperationalError("(pymysql.err.OperationalError) (2013, 'Lost connection to MySQL...
    │    └ <function raise_ at 0x0000029370F6AF80>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1930, in _execute_context
    self._commit_impl(autocommit=True)
    │    └ <function Connection._commit_impl at 0x00000293717751B0>
    └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1091, in _commit_impl
    self._handle_dbapi_exception(e, None, None, None, None)
    │    └ <function Connection._handle_dbapi_exception at 0x0000029371776050>
    └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x0000029370F6AF80>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1089, in _commit_impl
    self.engine.dialect.do_commit(self.connection)
    │    │      │       │         │    └ <property object at 0x0000029371759EE0>
    │    │      │       │         └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>
    │    │      │       └ <function DefaultDialect.do_commit at 0x00000293717BACB0>
    │    │      └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000002930B94E5C0>
    │    └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
    └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 686, in do_commit
    dbapi_connection.commit()
    └ <sqlalchemy.pool.base._ConnectionFairy object at 0x000002930B935F60>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 470, in commit
    self._read_ok_packet()
    │    └ <function Connection._read_ok_packet at 0x000002930BB6DEA0>
    └ <pymysql.connections.Connection object at 0x000002930B935E70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 443, in _read_ok_packet
    pkt = self._read_packet()
          │    └ <function Connection._read_packet at 0x000002930BB6E9E0>
          └ <pymysql.connections.Connection object at 0x000002930B935E70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 692, in _read_packet
    packet_header = self._read_bytes(4)
                    │    └ <function Connection._read_bytes at 0x000002930BB6EA70>
                    └ <pymysql.connections.Connection object at 0x000002930B935E70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 738, in _read_bytes
    raise err.OperationalError(
          │   └ <class 'pymysql.err.OperationalError'>
          └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query ([WinError 10054] 远程主机强迫关闭了一个现有的连接。)')
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-04-14 13:00:52.328 | SUCCESS  | __main__:mode_a:323 - added 3 img data....
2023-04-14 13:00:52.330 | INFO     | __main__:link_db:139 - 连接数据库中...........
2023-04-14 13:01:00.477 | ERROR    | __main__:mode_a:282 - An error has been caught in function 'mode_a', process 'MainProcess' (5548), thread 'MainThread' (14808):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 613, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x000002936F287EB0>
           └ <module 'socket' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\socket.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\socket.py", line 845, in create_connection
    raise err
          └ None

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\socket.py", line 833, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3306)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0>

ConnectionRefusedError: [WinError 10061] 由于目标计算机积极拒绝，无法连接。


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           └ <bound method Pool.connect of <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 320, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x0000029371793F40>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 884, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x0000029371793640>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 486, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x00000293717AE710>
          └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x0000029370F6AF80>
    └ <module 'sqlalchemy.util.compat' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalch...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x0000029371792DD0>
           └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 266, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 381, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002930B85C730>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 677, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x0000029370F6AF80>
    └ <module 'sqlalchemy.util.compat' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalch...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 673, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002930B85C730>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000002930BDE2200>
    │    │                               └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
    │    └ None
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002930B85C730>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'database': 'kimgdb', 'user': 'root', 'password': '778899vvbbnnmm', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x00000293717BA830>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000002930B85ED40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           │    │     │        │        └ {'host': 'localhost', 'database': 'kimgdb', 'user': 'root', 'password': '778899vvbbnnmm', 'client_flag': 2}
           │    │     │        └ ()
           │    │     └ <class 'pymysql.connections.Connection'>
           │    └ <module 'pymysql' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\__init__.py'>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000002930B85ED40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 353, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x000002930BB6E8C0>
    └ <pymysql.connections.Connection object at 0x000002930B85FDC0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 664, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab\main_v1.8.py", line 334, in <module>
    mode_a()
    └ <function mode_a at 0x000002930B8F1900>

> File "f:\k_grab\main_v1.8.py", line 282, in mode_a
    engine,kimg_table,tags_table=link_db()
    │      │                     └ <function link_db at 0x000002930B8F1480>
    │      └ 'kimg'
    └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

  File "f:\k_grab\main_v1.8.py", line 167, in link_db
    raise e

  File "f:\k_grab\main_v1.8.py", line 154, in link_db
    engine=engine.connect()
           │      └ <function Engine.connect at 0x0000029371779630>
           └ Engine(mysql+pymysql://root:***@localhost/kimgdb)

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           │    │               │                       └ False
           │    │               └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+pymysql://root:***@localhost/kimgdb)

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         │      └ <function Engine.raw_connection at 0x0000029371779AB0>
         └ Engine(mysql+pymysql://root:***@localhost/kimgdb)

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           │    │                  │    │    │        └ None
           │    │                  │    │    └ <function Pool.connect at 0x0000029371793010>
           │    │                  │    └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
           │    │                  └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
           │    └ <function Engine._wrap_pool_connect at 0x00000293717796C0>
           └ Engine(mysql+pymysql://root:***@localhost/kimgdb)

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x00000293717760E0>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
    │    └ <function raise_ at 0x0000029370F6AF80>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           └ <bound method Pool.connect of <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 320, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x0000029371793F40>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 884, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x0000029371793640>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 486, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x00000293717AE710>
          └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x0000029370F6AF80>
    └ <module 'sqlalchemy.util.compat' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalch...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x0000029371792DD0>
           └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 266, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 381, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002930B85C730>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 677, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x0000029370F6AF80>
    └ <module 'sqlalchemy.util.compat' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalch...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 673, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002930B85C730>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x000002930BDE2200>
    │    │                               └ <sqlalchemy.pool.impl.QueuePool object at 0x000002930B85DD50>
    │    └ None
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x000002930B85C730>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'database': 'kimgdb', 'user': 'root', 'password': '778899vvbbnnmm', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x00000293717BA830>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000002930B85ED40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           │    │     │        │        └ {'host': 'localhost', 'database': 'kimgdb', 'user': 'root', 'password': '778899vvbbnnmm', 'client_flag': 2}
           │    │     │        └ ()
           │    │     └ <class 'pymysql.connections.Connection'>
           │    └ <module 'pymysql' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\__init__.py'>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000002930B85ED40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 353, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x000002930BB6E8C0>
    └ <pymysql.connections.Connection object at 0x000002930B85FDC0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 664, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")

sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-04-14 13:01:00.582 | ERROR    | __main__:<module>:334 - An error has been caught in function '<module>', process 'MainProcess' (5548), thread 'MainThread' (14808):
Traceback (most recent call last):

> File "f:\k_grab\main_v1.8.py", line 334, in <module>
    mode_a()
    └ <function mode_a at 0x000002930B8F1900>

  File "f:\k_grab\main_v1.8.py", line 282, in mode_a
    engine,kimg_table,tags_table=link_db()
    │      │                     └ <function link_db at 0x000002930B8F1480>
    │      └ 'kimg'
    └ <sqlalchemy.engine.base.Connection object at 0x000002930B94E4D0>

TypeError: cannot unpack non-iterable NoneType object
