2023-08-28 15:50:58.387 | INFO     | __main__:<module>:397 - 获取headers.......
2023-08-28 15:50:58.390 | INFO     | __main__:<module>:410 - 获取headers.......
2023-08-28 16:22:08.614 | INFO     | __main__:<module>:290 - 获取headers.......
2023-08-28 16:22:08.617 | INFO     | __main__:<module>:303 - 自动获取headers.......
2023-08-28 16:22:09.217 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 16:22:09.690 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 16:22:18.018 | ERROR    | cellfunctions_:get_headers:113 - 取cookie及headers失败
2023-08-28 16:23:39.759 | INFO     | __main__:<module>:290 - 获取headers.......
2023-08-28 16:23:39.762 | INFO     | __main__:<module>:303 - 自动获取headers.......
2023-08-28 16:23:40.543 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 16:23:41.007 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 16:23:49.361 | ERROR    | cellfunctions_:get_headers:113 - 取cookie及headers失败
2023-08-28 16:24:30.467 | INFO     | __main__:<module>:290 - 获取headers.......
2023-08-28 16:24:30.467 | INFO     | __main__:<module>:303 - 自动获取headers.......
2023-08-28 16:24:31.029 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 16:24:31.514 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 16:24:40.064 | ERROR    | cellfunctions_:get_headers:113 - 取cookie及headers失败
2023-08-28 16:25:25.929 | INFO     | __main__:<module>:290 - 获取headers.......
2023-08-28 16:25:25.933 | INFO     | __main__:<module>:303 - 自动获取headers.......
2023-08-28 16:25:26.514 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 16:25:26.994 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 16:25:33.724 | SUCCESS  | cellfunctions_:get_headers:109 - 获取cookie及headers成功
2023-08-28 16:25:33.851 | SUCCESS  | __main__:<module>:306 - 获取headers成功......
2023-08-28 16:25:33.851 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:2
2023-08-28 16:25:33.851 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 16:25:33.851 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:.\pictures
2023-08-28 16:25:33.851 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 16:25:33.867 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 16:25:33.918 | ERROR    | __main__:mode_a:204 - An error has been caught in function 'mode_a', process 'MainProcess' (9052), thread 'MainThread' (11248):
Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 310, in <module>
    mode_a()
    └ <function mode_a at 0x000001F7D89022A0>

> File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
                                     └ <function link_db at 0x000001F7D8901B20>

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 55, in link_db
    raise e

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 38, in link_db
    engine = create_engine(
             └ <function create_engine at 0x000001F7CF67F920>

  File "<string>", line 2, in create_engine
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           │   │       └ {}
           │   └ ('mysql+pymysql://root:@localhost/kimgdb',)
           └ <function create_engine at 0x000001F7CF67F600>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 601, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
            │            └ {}
            └ <bound method MySQLDialect_pymysql.import_dbapi of <class 'sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql'>>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\dialects\mysql\pymysql.py", line 75, in import_dbapi
    return __import__("pymysql")

ModuleNotFoundError: No module named 'pymysql'
2023-08-28 16:25:33.933 | ERROR    | __main__:mode_a:206 - 没有数据库连接,请检查数据库是否启用
2023-08-28 16:25:33.935 | ERROR    | __main__:<module>:310 - An error has been caught in function '<module>', process 'MainProcess' (9052), thread 'MainThread' (11248):
Traceback (most recent call last):

> File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 310, in <module>
    mode_a()
    └ <function mode_a at 0x000001F7D89022A0>

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 207, in mode_a
    raise e

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
                                     └ <function link_db at 0x000001F7D8901B20>

TypeError: cannot unpack non-iterable NoneType object
2023-08-28 16:25:33.942 | SUCCESS  | __main__:<module>:319 - 下载任务完成
2023-08-28 16:53:30.537 | INFO     | __main__:<module>:291 - 获取headers.......
2023-08-28 16:53:30.537 | INFO     | __main__:<module>:304 - 自动获取headers.......
2023-08-28 16:53:31.116 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 16:53:31.581 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 16:53:39.391 | SUCCESS  | cellfunctions_:get_headers:109 - 获取cookie及headers成功
2023-08-28 16:53:39.457 | SUCCESS  | __main__:<module>:307 - 获取headers成功......
2023-08-28 16:53:39.458 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:2
2023-08-28 16:53:39.459 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 16:53:39.460 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:.\pictures
2023-08-28 16:53:39.461 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 16:53:39.462 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 16:53:39.492 | ERROR    | __main__:mode_a:204 - An error has been caught in function 'mode_a', process 'MainProcess' (3108), thread 'MainThread' (9748):
Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 311, in <module>
    mode_a()
    └ <function mode_a at 0x000001938F2362A0>

> File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
                                     └ <function link_db at 0x000001938F235B20>

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 55, in link_db
    raise e

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 38, in link_db
    engine = create_engine(
             └ <function create_engine at 0x0000019385FAF920>

  File "<string>", line 2, in create_engine
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           │   │       └ {}
           │   └ ('mysql+pymysql://root:@localhost/kimgdb',)
           └ <function create_engine at 0x0000019385FAF600>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 601, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
            │            └ {}
            └ <bound method MySQLDialect_pymysql.import_dbapi of <class 'sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql'>>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\dialects\mysql\pymysql.py", line 75, in import_dbapi
    return __import__("pymysql")

ModuleNotFoundError: No module named 'pymysql'
2023-08-28 16:53:39.505 | ERROR    | __main__:mode_a:206 - 没有数据库连接,请检查数据库是否启用
2023-08-28 17:18:19.755 | INFO     | __main__:<module>:291 - 获取headers.......
2023-08-28 17:18:19.755 | INFO     | __main__:<module>:304 - 自动获取headers.......
2023-08-28 17:18:20.377 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 17:18:20.782 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 17:18:29.130 | ERROR    | cellfunctions_:get_headers:113 - 取cookie及headers失败
2023-08-28 17:19:29.300 | INFO     | __main__:<module>:291 - 获取headers.......
2023-08-28 17:19:29.300 | INFO     | __main__:<module>:304 - 自动获取headers.......
2023-08-28 17:19:29.935 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 17:19:30.303 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 17:19:38.628 | ERROR    | cellfunctions_:get_headers:113 - 取cookie及headers失败
2023-08-28 17:20:04.764 | INFO     | __main__:<module>:291 - 获取headers.......
2023-08-28 17:20:04.766 | INFO     | __main__:<module>:304 - 自动获取headers.......
2023-08-28 17:20:05.401 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 17:20:05.805 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 17:20:14.120 | ERROR    | cellfunctions_:get_headers:114 - 取cookie及headers失败
2023-08-28 17:21:09.262 | ERROR    | asyncio.events:_run:80 - An error has been caught in function '_run', process 'MainProcess' (5620), thread 'MainThread' (2476):
Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 294, in <module>
    dread = dict(json.load(f))
                 │    │    └ <_io.TextIOWrapper name='headers_firefox.json' mode='r' encoding='utf-8'>
                 │    └ <function load at 0x000001E01398B240>
                 └ <module 'json' from 'C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\json\\__init__.py'>

  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
           │     │  └ <method 'read' of '_io.TextIOWrapper' objects>
           │     └ <_io.TextIOWrapper name='headers_firefox.json' mode='r' encoding='utf-8'>
           └ <function loads at 0x000001E01398B2E0>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           │                │      └ '\n'
           │                └ <function JSONDecoder.decode at 0x000001E01398AB60>
           └ <json.decoder.JSONDecoder object at 0x000001E0139E7490>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               │    │          │      │  └ '\n'
               │    │          │      └ <built-in method match of re.Pattern object at 0x000001E013A058A0>
               │    │          └ '\n'
               │    └ <function JSONDecoder.raw_decode at 0x000001E01398AC00>
               └ <json.decoder.JSONDecoder object at 0x000001E0139E7490>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
          │                                  └ '\n'
          └ <class 'json.decoder.JSONDecodeError'>

json.decoder.JSONDecodeError: Expecting value: line 2 column 1 (char 1)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 305, in <module>
    headers = asyncio.run(get_headers())
              │       │   └ <function get_headers at 0x000001E01D625620>
              │       └ <function run at 0x000001E012D5B420>
              └ <module 'asyncio' from 'C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object get_headers at 0x000001E01D5BA540>
           │      └ <function Runner.run at 0x000001E012E1E3E0>
           └ <asyncio.runners.Runner object at 0x000001E01D0DB090>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<get_headers() running at c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\l...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001E012E13F60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001E01D0DB090>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001E012EE7EC0>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001E012E1DD00>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001E012D5BD80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "c:\Users\Administrator\Desktop\k_grab1.9\cellfunctions_.py", line 116, in get_headers
    raise e

  File "c:\Users\Administrator\Desktop\k_grab1.9\cellfunctions_.py", line 85, in get_headers
    re = await page.goto(host)
               │    │    └ 'https://konachan.com'
               │    └ <function Page.goto at 0x000001E01D53BEC0>
               └ <Page url='about:blank'>

  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\playwright\async_api\_generated.py", line 9251, in goto
    await self._impl_obj.goto(
          │    │         └ <function Page.goto at 0x000001E01D4F1760>
          │    └ <Page url='about:blank'>
          └ <Page url='about:blank'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\playwright\_impl\_page.py", line 479, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
                 │    │           │      └ <function locals_to_params at 0x000001E01D205B20>
                 │    │           └ <function Frame.goto at 0x000001E01D2BFA60>
                 │    └ <Frame name= url='about:blank'>
                 └ <Page url='about:blank'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\playwright\_impl\_frame.py", line 147, in goto
    await self._channel.send("goto", locals_to_params(locals()))
          │    │        │            └ <function locals_to_params at 0x000001E01D205B20>
          │    │        └ <function Channel.send at 0x000001E01D206840>
          │    └ <playwright._impl._connection.Channel object at 0x000001E01D92B590>
          └ <Frame name= url='about:blank'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
                 │    │           └ <function Connection.wrap_api_call at 0x000001E01D260680>
                 │    └ <playwright._impl._connection.Connection object at 0x000001E01CDFBF90>
                 └ <playwright._impl._connection.Channel object at 0x000001E01D92B590>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 482, in wrap_api_call
    return await cb()
                 └ <function Channel.send.<locals>.<lambda> at 0x000001E01D91E8E0>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 97, in inner_send
    result = next(iter(done)).result()
                       └ {<Future finished exception=Error('net::ERR_TIMED_OUT at https://konachan.com/\n=========================== logs ============...

playwright._impl._api_types.Error: net::ERR_TIMED_OUT at https://konachan.com/
=========================== logs ===========================
navigating to "https://konachan.com/", waiting until "load"
============================================================
2023-08-28 17:21:09.291 | SUCCESS  | __main__:<module>:307 - 获取headers成功......
2023-08-28 17:21:09.293 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:20
2023-08-28 17:21:09.294 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 17:21:09.297 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:.\pictures
2023-08-28 17:21:09.299 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 17:21:09.301 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 17:21:09.351 | ERROR    | __main__:mode_a:204 - An error has been caught in function 'mode_a', process 'MainProcess' (5620), thread 'MainThread' (2476):
Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 311, in <module>
    mode_a()
    └ <function mode_a at 0x000001E01D626520>

> File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
                                     └ <function link_db at 0x000001E01D625DA0>

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 55, in link_db
    raise e

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 38, in link_db
    engine = create_engine(
             └ <function create_engine at 0x000001E01438F920>

  File "<string>", line 2, in create_engine
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           │   │       └ {}
           │   └ ('mysql+pymysql://root:@localhost/kimgdb',)
           └ <function create_engine at 0x000001E01438F600>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 601, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
            │            └ {}
            └ <bound method MySQLDialect_pymysql.import_dbapi of <class 'sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql'>>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\dialects\mysql\pymysql.py", line 75, in import_dbapi
    return __import__("pymysql")

ModuleNotFoundError: No module named 'pymysql'
2023-08-28 17:21:09.371 | ERROR    | __main__:mode_a:206 - 没有数据库连接,请检查数据库是否启用
2023-08-28 17:21:21.175 | INFO     | __main__:<module>:291 - 获取headers.......
2023-08-28 17:21:21.177 | INFO     | __main__:<module>:304 - 自动获取headers.......
2023-08-28 17:21:21.788 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 17:21:22.284 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 17:21:31.068 | SUCCESS  | cellfunctions_:get_headers:110 - 获取cookie及headers成功
2023-08-28 17:21:31.280 | SUCCESS  | __main__:<module>:307 - 获取headers成功......
2023-08-28 17:21:31.282 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:20
2023-08-28 17:21:31.283 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 17:21:31.284 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:.\pictures
2023-08-28 17:21:31.285 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 17:21:31.286 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 17:21:31.319 | ERROR    | __main__:mode_a:204 - An error has been caught in function 'mode_a', process 'MainProcess' (7840), thread 'MainThread' (6528):
Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 311, in <module>
    mode_a()
    └ <function mode_a at 0x000002DFB1D86520>

> File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
                                     └ <function link_db at 0x000002DFB1D85DA0>

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 55, in link_db
    raise e

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 38, in link_db
    engine = create_engine(
             └ <function create_engine at 0x000002DFA8AEF920>

  File "<string>", line 2, in create_engine
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           │   │       └ {}
           │   └ ('mysql+pymysql://root:@localhost/kimgdb',)
           └ <function create_engine at 0x000002DFA8AEF600>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 601, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
            │            └ {}
            └ <bound method MySQLDialect_pymysql.import_dbapi of <class 'sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql'>>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\dialects\mysql\pymysql.py", line 75, in import_dbapi
    return __import__("pymysql")

ModuleNotFoundError: No module named 'pymysql'
2023-08-28 17:21:31.334 | ERROR    | __main__:mode_a:206 - 没有数据库连接,请检查数据库是否启用
2023-08-28 17:21:39.144 | ERROR    | __main__:<module>:311 - An error has been caught in function '<module>', process 'MainProcess' (7840), thread 'MainThread' (6528):
Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
                                     └ <function link_db at 0x000002DFB1D85DA0>

TypeError: cannot unpack non-iterable NoneType object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

> File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 311, in <module>
    mode_a()
    └ <function mode_a at 0x000002DFB1D86520>

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 208, in mode_a
    raise e

  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
           │    │             └ <frame at 0x000002DFB1D0DF80, file 'c:\\Users\\Administrator\\Desktop\\k_grab1.9\\main.py', line 208, code mode_a>
           │    └ <function Bdb.dispatch_line at 0x000002DFB2209E40>
           └ <pdb.Pdb object at 0x000002DFB21C3150>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
       │    │               └ <class 'bdb.BdbQuit'>
       │    └ True
       └ <pdb.Pdb object at 0x000002DFB21C3150>

bdb.BdbQuit
2023-08-28 17:21:39.144 | SUCCESS  | __main__:<module>:320 - 下载任务完成
2023-08-28 17:23:55.962 | INFO     | __main__:<module>:293 - 获取headers.......
2023-08-28 17:23:55.964 | INFO     | __main__:<module>:306 - 自动获取headers.......
2023-08-28 17:23:56.581 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 17:23:57.066 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 17:24:08.493 | SUCCESS  | cellfunctions_:get_headers:110 - 获取cookie及headers成功
2023-08-28 17:24:08.669 | SUCCESS  | __main__:<module>:309 - 获取headers成功......
2023-08-28 17:24:08.669 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:20
2023-08-28 17:24:08.669 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 17:24:08.669 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:.\pictures
2023-08-28 17:24:08.669 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 17:24:08.669 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 17:24:08.700 | ERROR    | __main__:mode_a:204 - An error has been caught in function 'mode_a', process 'MainProcess' (724), thread 'MainThread' (1656):
Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 313, in <module>
    mode_a()
    └ <function mode_a at 0x0000019AC3E06200>

> File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
                                     └ <function link_db at 0x0000019AC3E05A80>

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 55, in link_db
    raise e

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 38, in link_db
    engine = create_engine(
             └ <function create_engine at 0x0000019ABAB7F880>

  File "<string>", line 2, in create_engine
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           │   │       └ {}
           │   └ ('mysql+pymysql://root:@localhost/kimgdb',)
           └ <function create_engine at 0x0000019ABAB7F560>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 601, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
            │            └ {}
            └ <bound method MySQLDialect_pymysql.import_dbapi of <class 'sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql'>>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\dialects\mysql\pymysql.py", line 75, in import_dbapi
    return __import__("pymysql")

ModuleNotFoundError: No module named 'pymysql'
2023-08-28 17:24:08.716 | ERROR    | __main__:mode_a:206 - 没有数据库连接,请检查数据库是否启用
2023-08-28 17:27:06.461 | INFO     | __main__:<module>:293 - 获取headers.......
2023-08-28 17:27:06.463 | INFO     | __main__:<module>:306 - 自动获取headers.......
2023-08-28 17:27:07.050 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 17:27:07.513 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 17:27:16.008 | SUCCESS  | cellfunctions_:get_headers:110 - 获取cookie及headers成功
2023-08-28 17:27:16.174 | SUCCESS  | __main__:<module>:309 - 获取headers成功......
2023-08-28 17:27:16.174 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:20
2023-08-28 17:27:16.174 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 17:27:16.174 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:.\pictures
2023-08-28 17:27:16.174 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 17:27:16.174 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 17:27:18.272 | ERROR    | __main__:mode_a:204 - An error has been caught in function 'mode_a', process 'MainProcess' (9648), thread 'MainThread' (9772):
Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\pymysql\connections.py", line 644, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000015DBEBAA2A0>
           └ <module 'socket' from 'C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\socket.py'>
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 851, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 836, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3306)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] 由于目标计算机积极拒绝，无法连接。


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x0000015DC1CE6840>
    │                        └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
    └ <sqlalchemy.engine.base.Connection object at 0x0000015DCB3C5D50>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3288, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x0000015DC0FF1EE0>
           │    └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
           └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x0000015DC0FF3F60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x0000015DC0FF2AC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 716, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x0000015DC1003560>
          └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 169, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'c:\\Users\\Administrator\\Desktop\\k_grab1.9\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__...
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 147, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000015DCB319580>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 167, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x0000015DC0FF1C60>
           └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 678, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000015DCB3BA820>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 902, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'c:\\Users\\Administrator\\Desktop\\k_grab1.9\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__...
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 147, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000015DCB31E580>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000015DCB3BA820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x0000015DCAF86B60>
    │    │                               └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000015DCB3BA820>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 637, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'database': 'kimgdb', 'user': 'root', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x0000015DC1D820C0>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000015DCB3A6290>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 615, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'database': 'kimgdb', 'user': 'root', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <class 'pymysql.connections.Connection'>
           │    └ <module 'pymysql' from 'c:\\Users\\Administrator\\Desktop\\k_grab1.9\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000015DCB3A6290>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000015DCB433E20>
    └ <pymysql.connections.Connection object at 0x0000015DC7F35450>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 313, in <module>
    mode_a()
    └ <function mode_a at 0x0000015DCAF86200>

> File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
                                     └ <function link_db at 0x0000015DCAF85A80>

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 55, in link_db
    raise e

  File "c:\Users\Administrator\Desktop\k_grab1.9\main.py", line 41, in link_db
    engine = engine.connect()
             │      └ <function Engine.connect at 0x0000015DC1CE67A0>
             └ Engine(mysql+pymysql://root:***@localhost/kimgdb)

  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3264, in connect
    return self._connection_cls(self)
           │    │               └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x0000015DC1CE4040>)>
    └ <class 'sqlalchemy.engine.base.Connection'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2426, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
          │                    │              └ (<class 'pymysql.err.OperationalError'>, OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 1006...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(pymysql.err.OperationalError) (2003, "Can\'t connect to MySQL server on \'localhost\' ([WinError 10061] 由于...
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
    │                        │      └ <function Engine.raw_connection at 0x0000015DC1CE6840>
    │                        └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
    └ <sqlalchemy.engine.base.Connection object at 0x0000015DCB3C5D50>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3288, in raw_connection
    return self.pool.connect()
           │    │    └ <function Pool.connect at 0x0000015DC0FF1EE0>
           │    └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
           └ Engine(mysql+pymysql://root:***@localhost/kimgdb)
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x0000015DC0FF3F60>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x0000015DC0FF2AC0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 716, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x0000015DC1003560>
          └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 169, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'c:\\Users\\Administrator\\Desktop\\k_grab1.9\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__...
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 147, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000015DCB319580>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 167, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x0000015DC0FF1C60>
           └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 678, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000015DCB3BA820>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 902, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'c:\\Users\\Administrator\\Desktop\\k_grab1.9\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__...
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 147, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000015DCB31E580>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000015DCB3BA820>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x0000015DCAF86B60>
    │    │                               └ <sqlalchemy.pool.impl.QueuePool object at 0x0000015DCAA1F150>
    │    └ <member 'dbapi_connection' of '_ConnectionRecord' objects>
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x0000015DCB3BA820>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 637, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'database': 'kimgdb', 'user': 'root', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x0000015DC1D820C0>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000015DCB3A6290>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 615, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           │    │            │        │        └ {'host': 'localhost', 'database': 'kimgdb', 'user': 'root', 'client_flag': 2}
           │    │            │        └ ()
           │    │            └ <class 'pymysql.connections.Connection'>
           │    └ <module 'pymysql' from 'c:\\Users\\Administrator\\Desktop\\k_grab1.9\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000015DCB3A6290>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000015DCB433E20>
    └ <pymysql.connections.Connection object at 0x0000015DC7F35450>
  File "c:\Users\Administrator\Desktop\k_grab1.9\.venv\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")

sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-08-28 17:27:18.328 | ERROR    | __main__:mode_a:206 - 没有数据库连接,请检查数据库是否启用
2023-08-28 21:55:11.233 | INFO     | __main__:<module>:293 - 获取headers.......
2023-08-28 21:55:11.235 | INFO     | __main__:<module>:306 - 自动获取headers.......
2023-08-28 21:55:11.906 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 21:55:12.471 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 21:55:12.865 | ERROR    | cellfunctions_:get_headers:116 - 取cookie及headers失败
2023-08-28 21:55:55.208 | ERROR    | __main__:<module>:307 - An error has been caught in function '<module>', process 'MainProcess' (28056), thread 'MainThread' (15628):
Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 296, in <module>
    dread = dict(json.load(f))
                 │    │    └ <_io.TextIOWrapper name='headers_firefox.json' mode='r' encoding='utf-8'>
                 │    └ <function load at 0x000002300F24C5E0>
                 └ <module 'json' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\json\\__init__.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
           │     │  └ <method 'read' of '_io.TextIOWrapper' objects>
           │     └ <_io.TextIOWrapper name='headers_firefox.json' mode='r' encoding='utf-8'>
           └ <function loads at 0x000002300F24C670>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           │                │      └ '\n'
           │                └ <function JSONDecoder.decode at 0x000002300F1F7D90>
           └ <json.decoder.JSONDecoder object at 0x000002300F22D090>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               │    │          │      │  └ '\n'
               │    │          │      └ <built-in method match of re.Pattern object at 0x000002300F1E5560>
               │    │          └ '\n'
               │    └ <function JSONDecoder.raw_decode at 0x000002300F1F7E20>
               └ <json.decoder.JSONDecoder object at 0x000002300F22D090>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
          │                                  └ '\n'
          └ <class 'json.decoder.JSONDecodeError'>

json.decoder.JSONDecodeError: Expecting value: line 2 column 1 (char 1)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

> File "f:\k_grab1.9\main.py", line 307, in <module>
    headers = get_headers()
              └ <function get_headers at 0x0000023029A0D000>

  File "f:\k_grab1.9\cellfunctions_.py", line 118, in get_headers
    raise e

  File "f:\k_grab1.9\cellfunctions_.py", line 85, in get_headers
    re = page.goto(host)
         │    │    └ 'https://konachan.com'
         │    └ <function Page.goto at 0x00000230299535B0>
         └ <Page url='about:blank'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\playwright\sync_api\_generated.py", line 9256, in goto
    self._sync(
    │    └ <function SyncBase._sync at 0x0000023029932050>
    └ <Page url='about:blank'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\playwright\_impl\_sync_base.py", line 104, in _sync
    return task.result()
           │    └ <method 'result' of '_asyncio.Task' objects>
           └ <Task finished name='Task-27' coro=<Page.goto() done, defined at C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\playwright\_impl\_page.py", line 495, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
                 │    │           │      └ <function locals_to_params at 0x000002302988C430>
                 │    │           └ <function Frame.goto at 0x00000230298DBD90>
                 │    └ <Frame name= url='about:blank'>
                 └ <Page url='about:blank'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\playwright\_impl\_frame.py", line 147, in goto
    await self._channel.send("goto", locals_to_params(locals()))
          │    │        │            └ <function locals_to_params at 0x000002302988C430>
          │    │        └ <function Channel.send at 0x000002302988CF70>
          │    └ <playwright._impl._connection.Channel object at 0x0000023029A10880>
          └ <Frame name= url='about:blank'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
                 │    │           └ <function Connection.wrap_api_call at 0x000002302988E830>
                 │    └ <playwright._impl._connection.Connection object at 0x0000023029A12EC0>
                 └ <playwright._impl._connection.Channel object at 0x0000023029A10880>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\playwright\_impl\_connection.py", line 461, in wrap_api_call
    return await cb()
                 └ <function Channel.send.<locals>.<lambda> at 0x0000023029D80CA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\playwright\_impl\_connection.py", line 96, in inner_send
    result = next(iter(done)).result()
                       └ {<Future finished exception=Error('net::ERR_EMPTY_RESPONSE at https://konachan.com/\n=========================== logs =======...

playwright._impl._api_types.Error: net::ERR_EMPTY_RESPONSE at https://konachan.com/
=========================== logs ===========================
navigating to "https://konachan.com/", waiting until "load"
============================================================
2023-08-28 21:55:55.295 | SUCCESS  | __main__:<module>:309 - 获取headers成功......
2023-08-28 21:55:55.299 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:20
2023-08-28 21:55:55.301 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 21:55:55.303 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 21:55:55.304 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 21:55:55.307 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 21:55:55.626 | SUCCESS  | __main__:link_db:48 - 图像数据表: kimg
2023-08-28 21:55:55.628 | SUCCESS  | __main__:link_db:49 - tag数据表: tags
2023-08-28 21:55:55.630 | SUCCESS  | __main__:link_db:51 - link dbas 准备导入数据.....
2023-08-28 21:55:55.690 | ERROR    | __main__:mode_a:218 - 无法从kimg找到pid
2023-08-28 21:57:58.958 | ERROR    | __main__:<module>:313 - An error has been caught in function '<module>', process 'MainProcess' (28056), thread 'MainThread' (15628):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002300F53FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000023029EE96F0>
    └ <sqlalchemy.engine.base.Connection object at 0x000002302A03A140>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'select distinct pid from kimg;'
    │      └ <function Cursor.execute at 0x000002302A02CEE0>
    └ <pymysql.cursors.Cursor object at 0x000002302A03ADA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'select distinct pid from kimg;'
             │    └ <function Cursor._query at 0x000002302A02D360>
             └ <pymysql.cursors.Cursor object at 0x000002302A03ADA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'select distinct pid from kimg;'
    │    └ <function Connection.query at 0x000002302A0403A0>
    └ <pymysql.connections.Connection object at 0x000002302A038CA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x000002302A0409D0>
    │    │                └ <pymysql.connections.Connection object at 0x000002302A038CA0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x000002302A038CA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x000002302A0411B0>
    └ <pymysql.connections.MySQLResult object at 0x000002302A03A7D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x000002302A03A7D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x000002302A02EF80>
    └ <pymysql.protocol.MysqlPacket object at 0x000002302A03B160>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x000002302A03B160>
    │   └ <function raise_mysql_exception at 0x0000023029F44B80>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Table 'testdb.kimg' doesn't exist"
          │          └ 1146
          └ <class 'pymysql.err.ProgrammingError'>

pymysql.err.ProgrammingError: (1146, "Table 'testdb.kimg' doesn't exist")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "f:\k_grab1.9\main.py", line 313, in <module>
    mode_a()
    └ <function mode_a at 0x0000023029A0DEA0>

  File "f:\k_grab1.9\main.py", line 220, in mode_a
    raise e

  File "f:\k_grab1.9\main.py", line 212, in mode_a
    df_pid = pandas.read_sql(
             │      └ <function read_sql at 0x0000023028332C20>
             └ <module 'pandas' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pandas\\__init__.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 590, in read_sql
    return pandas_sql.read_query(
           │          └ <function SQLDatabase.read_query at 0x0000023028333F40>
           └ <pandas.io.sql.SQLDatabase object at 0x000002302A039960>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1560, in read_query
    result = self.execute(*args)
             │    │        └ [<sqlalchemy.sql.elements.TextClause object at 0x0000023029A13010>]
             │    └ <function SQLDatabase.execute at 0x0000023028333D90>
             └ <pandas.io.sql.SQLDatabase object at 0x000002302A039960>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1405, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
           │    │           │                            │       └ {}
           │    │           │                            └ (<sqlalchemy.sql.elements.TextClause object at 0x0000023029A13010>,)
           │    │           └ <function Connection.execution_options at 0x000002300F494B80>
           │    └ <sqlalchemy.engine.base.Connection object at 0x0000023029EE9600>
           └ <pandas.io.sql.SQLDatabase object at 0x000002302A039960>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           │    │     │            │       └ immutabledict({})
           │    │     │            └ {}
           │    │     └ ()
           │    └ <sqlalchemy.engine.base.Connection object at 0x000002302A03A140>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.elements.TextClause object at 0x0000023029A13010>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000002300F496710>
           └ <sqlalchemy.engine.base.Connection object at 0x000002302A03A140>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000002300F4969E0>
          └ <sqlalchemy.engine.base.Connection object at 0x000002302A03A140>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000002300F496B90>
    └ <sqlalchemy.engine.base.Connection object at 0x000002302A03A140>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x000002300EC47AC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002300F53FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000023029EE96F0>
    └ <sqlalchemy.engine.base.Connection object at 0x000002302A03A140>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'select distinct pid from kimg;'
    │      └ <function Cursor.execute at 0x000002302A02CEE0>
    └ <pymysql.cursors.Cursor object at 0x000002302A03ADA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'select distinct pid from kimg;'
             │    └ <function Cursor._query at 0x000002302A02D360>
             └ <pymysql.cursors.Cursor object at 0x000002302A03ADA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'select distinct pid from kimg;'
    │    └ <function Connection.query at 0x000002302A0403A0>
    └ <pymysql.connections.Connection object at 0x000002302A038CA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x000002302A0409D0>
    │    │                └ <pymysql.connections.Connection object at 0x000002302A038CA0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x000002302A038CA0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x000002302A0411B0>
    └ <pymysql.connections.MySQLResult object at 0x000002302A03A7D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x000002302A03A7D0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x000002302A02EF80>
    └ <pymysql.protocol.MysqlPacket object at 0x000002302A03B160>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x000002302A03B160>
    │   └ <function raise_mysql_exception at 0x0000023029F44B80>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Table 'testdb.kimg' doesn't exist"
          │          └ 1146
          └ <class 'pymysql.err.ProgrammingError'>

sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'testdb.kimg' doesn't exist")
[SQL: select distinct pid from kimg;]
(Background on this error at: https://sqlalche.me/e/14/f405)
2023-08-28 21:57:59.136 | SUCCESS  | __main__:<module>:322 - 下载任务完成
2023-08-28 21:58:08.322 | INFO     | __main__:<module>:293 - 获取headers.......
2023-08-28 21:58:08.329 | INFO     | __main__:<module>:306 - 自动获取headers.......
2023-08-28 21:58:08.850 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 21:58:09.243 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 21:58:09.628 | ERROR    | cellfunctions_:get_headers:116 - 取cookie及headers失败
2023-08-28 21:58:41.529 | INFO     | __main__:<module>:293 - 获取headers.......
2023-08-28 21:58:41.531 | INFO     | __main__:<module>:306 - 自动获取headers.......
2023-08-28 21:58:42.062 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 21:58:42.448 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 21:58:42.834 | ERROR    | cellfunctions_:get_headers:116 - 取cookie及headers失败
2023-08-28 22:00:48.936 | INFO     | __main__:<module>:293 - 获取headers.......
2023-08-28 22:00:48.937 | INFO     | __main__:<module>:306 - 自动获取headers.......
2023-08-28 22:00:49.457 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 22:00:49.812 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 22:00:56.918 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 22:00:57.144 | SUCCESS  | __main__:<module>:309 - 获取headers成功......
2023-08-28 22:00:57.147 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:20
2023-08-28 22:00:57.148 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 22:00:57.151 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 22:00:57.153 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 22:00:57.154 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 22:00:57.393 | SUCCESS  | __main__:link_db:48 - 图像数据表: kimg
2023-08-28 22:00:57.396 | SUCCESS  | __main__:link_db:49 - tag数据表: tags
2023-08-28 22:00:57.397 | SUCCESS  | __main__:link_db:51 - link dbas 准备导入数据.....
2023-08-28 22:00:57.434 | ERROR    | __main__:mode_a:218 - 无法从kimg找到pid
2023-08-28 22:01:58.845 | ERROR    | __main__:<module>:313 - An error has been caught in function '<module>', process 'MainProcess' (15032), thread 'MainThread' (42268):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002032E91FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000203492746A0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000020349317CD0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'select distinct pid from kimg;'
    │      └ <function Cursor.execute at 0x000002034931C280>
    └ <pymysql.cursors.Cursor object at 0x000002034933C970>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'select distinct pid from kimg;'
             │    └ <function Cursor._query at 0x000002034931C700>
             └ <pymysql.cursors.Cursor object at 0x000002034933C970>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'select distinct pid from kimg;'
    │    └ <function Connection.query at 0x000002034931F6D0>
    └ <pymysql.connections.Connection object at 0x0000020349316830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x000002034931FD00>
    │    │                └ <pymysql.connections.Connection object at 0x0000020349316830>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x0000020349316830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000020349324550>
    └ <pymysql.connections.MySQLResult object at 0x000002034933C3A0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x000002034933C3A0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x000002034931E320>
    └ <pymysql.protocol.MysqlPacket object at 0x000002034933CD30>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x000002034933CD30>
    │   └ <function raise_mysql_exception at 0x00000203491A75B0>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Table 'testdb.kimg' doesn't exist"
          │          └ 1146
          └ <class 'pymysql.err.ProgrammingError'>

pymysql.err.ProgrammingError: (1146, "Table 'testdb.kimg' doesn't exist")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "f:\k_grab1.9\main.py", line 313, in <module>
    mode_a()
    └ <function mode_a at 0x0000020348DD1FC0>

  File "f:\k_grab1.9\main.py", line 220, in mode_a
    raise e

  File "f:\k_grab1.9\main.py", line 212, in mode_a
    df_pid = pandas.read_sql(
             │      └ <function read_sql at 0x0000020347712C20>
             └ <module 'pandas' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pandas\\__init__.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 590, in read_sql
    return pandas_sql.read_query(
           │          └ <function SQLDatabase.read_query at 0x0000020347713F40>
           └ <pandas.io.sql.SQLDatabase object at 0x00000203493174F0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1560, in read_query
    result = self.execute(*args)
             │    │        └ [<sqlalchemy.sql.elements.TextClause object at 0x0000020348DD52A0>]
             │    └ <function SQLDatabase.execute at 0x0000020347713D90>
             └ <pandas.io.sql.SQLDatabase object at 0x00000203493174F0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1405, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
           │    │           │                            │       └ {}
           │    │           │                            └ (<sqlalchemy.sql.elements.TextClause object at 0x0000020348DD52A0>,)
           │    │           └ <function Connection.execution_options at 0x000002032E874B80>
           │    └ <sqlalchemy.engine.base.Connection object at 0x00000203492745B0>
           └ <pandas.io.sql.SQLDatabase object at 0x00000203493174F0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           │    │     │            │       └ immutabledict({})
           │    │     │            └ {}
           │    │     └ ()
           │    └ <sqlalchemy.engine.base.Connection object at 0x0000020349317CD0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.elements.TextClause object at 0x0000020348DD52A0>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000002032E876710>
           └ <sqlalchemy.engine.base.Connection object at 0x0000020349317CD0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000002032E8769E0>
          └ <sqlalchemy.engine.base.Connection object at 0x0000020349317CD0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000002032E876B90>
    └ <sqlalchemy.engine.base.Connection object at 0x0000020349317CD0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x000002032E027AC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002032E91FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000203492746A0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000020349317CD0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'select distinct pid from kimg;'
    │      └ <function Cursor.execute at 0x000002034931C280>
    └ <pymysql.cursors.Cursor object at 0x000002034933C970>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'select distinct pid from kimg;'
             │    └ <function Cursor._query at 0x000002034931C700>
             └ <pymysql.cursors.Cursor object at 0x000002034933C970>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'select distinct pid from kimg;'
    │    └ <function Connection.query at 0x000002034931F6D0>
    └ <pymysql.connections.Connection object at 0x0000020349316830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x000002034931FD00>
    │    │                └ <pymysql.connections.Connection object at 0x0000020349316830>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x0000020349316830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000020349324550>
    └ <pymysql.connections.MySQLResult object at 0x000002034933C3A0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x000002034933C3A0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x000002034931E320>
    └ <pymysql.protocol.MysqlPacket object at 0x000002034933CD30>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x000002034933CD30>
    │   └ <function raise_mysql_exception at 0x00000203491A75B0>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Table 'testdb.kimg' doesn't exist"
          │          └ 1146
          └ <class 'pymysql.err.ProgrammingError'>

sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'testdb.kimg' doesn't exist")
[SQL: select distinct pid from kimg;]
(Background on this error at: https://sqlalche.me/e/14/f405)
2023-08-28 22:01:59.001 | SUCCESS  | __main__:<module>:322 - 下载任务完成
2023-08-28 22:02:10.953 | INFO     | __main__:<module>:293 - 获取headers.......
2023-08-28 22:02:10.954 | INFO     | __main__:<module>:306 - 自动获取headers.......
2023-08-28 22:02:11.472 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 22:02:11.832 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 22:02:19.495 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 22:02:19.724 | SUCCESS  | __main__:<module>:309 - 获取headers成功......
2023-08-28 22:02:19.726 | SUCCESS  | __main__:mode_a:195 - 单次下载数量:20
2023-08-28 22:02:19.728 | SUCCESS  | __main__:mode_a:196 - 并发数:20
2023-08-28 22:02:19.729 | SUCCESS  | __main__:mode_a:197 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 22:02:19.731 | SUCCESS  | __main__:mode_a:198 - 下载次数:200
2023-08-28 22:02:19.732 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 22:02:19.955 | SUCCESS  | __main__:link_db:48 - 图像数据表: kimg
2023-08-28 22:02:19.959 | SUCCESS  | __main__:link_db:49 - tag数据表: tags
2023-08-28 22:02:19.960 | SUCCESS  | __main__:link_db:51 - link dbas 准备导入数据.....
2023-08-28 22:02:19.990 | WARNING  | __main__:mode_a:218 - 无法从kimg找到pid
2023-08-28 22:02:19.992 | INFO     | __main__:mode_a:222 - 数据库共有0条图像数据
2023-08-28 22:02:21.862 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:21.870 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.199 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.553 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.612 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.826 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.832 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.848 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.855 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.910 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:22.920 | ERROR    | cellfunctions_:get_source:136 - 356645图片不存在或者被删除了
2023-08-28 22:02:22.922 | ERROR    | cellfunctions_:get_source:137 - https://konachan.com/post/show/356645/
2023-08-28 22:02:22.981 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:23.061 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:23.100 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:23.328 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:23.352 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:23.751 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:24.177 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:24.481 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:30.510 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:02:41.672 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360648
2023-08-28 22:02:41.675 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:41.893 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359493
2023-08-28 22:02:41.896 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:42.092 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359798
2023-08-28 22:02:42.095 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:42.285 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360655
2023-08-28 22:02:42.288 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:42.296 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360461
2023-08-28 22:02:42.298 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:42.612 | INFO     | cellfunctions_:save_img:243 - 保存图片中......356744
2023-08-28 22:02:42.615 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:42.972 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359361
2023-08-28 22:02:42.974 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:43.044 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359529
2023-08-28 22:02:43.047 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:44.337 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361430
2023-08-28 22:02:44.341 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:44.800 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361039
2023-08-28 22:02:44.804 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:45.272 | INFO     | cellfunctions_:save_img:243 - 保存图片中......355631
2023-08-28 22:02:45.288 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:45.362 | INFO     | cellfunctions_:save_img:243 - 保存图片中......355540
2023-08-28 22:02:45.366 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:45.761 | INFO     | cellfunctions_:save_img:243 - 保存图片中......356132
2023-08-28 22:02:45.764 | INFO     | cellfunctions_:save_img:243 - 保存图片中......358225
2023-08-28 22:02:45.765 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:45.768 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:46.024 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360764
2023-08-28 22:02:46.027 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:46.552 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360254
2023-08-28 22:02:46.568 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:55.433 | INFO     | cellfunctions_:save_img:243 - 保存图片中......356059
2023-08-28 22:02:55.437 | INFO     | cellfunctions_:save_img:243 - 保存图片中......357589
2023-08-28 22:02:55.439 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:55.440 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:55.588 | INFO     | cellfunctions_:save_img:243 - 保存图片中......358929
2023-08-28 22:02:55.591 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:02:55.593 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 19 img to IMG_PATH......
2023-08-28 22:02:55.600 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\359361.jpg
2023-08-28 22:02:55.606 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\359493.jpg
2023-08-28 22:02:55.612 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\356744.jpg
2023-08-28 22:02:55.619 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\360648.jpg
2023-08-28 22:02:55.623 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\360461.jpg
2023-08-28 22:02:55.629 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\360655.jpg
2023-08-28 22:02:55.632 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\361039.jpg
2023-08-28 22:02:55.638 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\358929.jpg
2023-08-28 22:02:55.642 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\358225.jpg
2023-08-28 22:02:55.647 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\355540.jpg
2023-08-28 22:02:55.653 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\357589.jpg
2023-08-28 22:02:55.656 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\361430.jpg
2023-08-28 22:02:55.663 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\356059.jpg
2023-08-28 22:02:55.668 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\356132.jpg
2023-08-28 22:02:55.673 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\359529.jpg
2023-08-28 22:02:55.678 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\355631.jpg
2023-08-28 22:02:55.684 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\359798.jpg
2023-08-28 22:02:55.690 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\360764.jpg
2023-08-28 22:02:55.696 | SUCCESS  | __main__:save_img_and_todb:104 - imported: F:\database_learn\k_spider\pictures10\360254.jpg
2023-08-28 22:02:55.783 | ERROR    | __main__:mode_a:251 - An error has been caught in function 'mode_a', process 'MainProcess' (11608), thread 'MainThread' (45968):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 732, in _read_bytes
    data = self._rfile.read(num_bytes)
           │    │           └ 4
           │    └ None
           └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\socket.py", line 705, in readinto
    return self._sock.recv_into(b)
           │    │               └ <memory at 0x00000140F5BFD0C0>
           │    └ None
           └ <socket.SocketIO object at 0x00000140F5C3AB30>

ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000140DB20FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000140F5B64E20>
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ '\nCREATE TABLE tags (\n\ttag TEXT\n)\n\n'
    │      └ <function Cursor.execute at 0x00000140F5C40280>
    └ <pymysql.cursors.Cursor object at 0x00000140F6EB14B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ '\nCREATE TABLE tags (\n\ttag TEXT\n)\n\n'
             │    └ <function Cursor._query at 0x00000140F5C40700>
             └ <pymysql.cursors.Cursor object at 0x00000140F6EB14B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ '\nCREATE TABLE tags (\n\ttag TEXT\n)\n\n'
    │    └ <function Connection.query at 0x00000140F5C436D0>
    └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x00000140F5C43D00>
    │    │                └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x00000140F5C48550>
    └ <pymysql.connections.MySQLResult object at 0x00000140F6EB2A70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x00000140F6EB2A70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 692, in _read_packet
    packet_header = self._read_bytes(4)
                    │    └ <function Connection._read_bytes at 0x00000140F5C43BE0>
                    └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 738, in _read_bytes
    raise err.OperationalError(
          │   └ <class 'pymysql.err.OperationalError'>
          └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query ([WinError 10054] 远程主机强迫关闭了一个现有的连接。)')


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 313, in <module>
    mode_a()
    └ <function mode_a at 0x00000140F5701FC0>

> File "f:\k_grab1.9\main.py", line 251, in mode_a
    save_img_and_todb(pids, engine, kimg_table, tags_table)
    │                 │     │       │           └ 'tags'
    │                 │     │       └ 'kimg'
    │                 │     └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>
    │                 └ [359361, 359493, 356744, 360648, 360461, 360655, 361039, 358929, 358225, 355540, 357589, 361430, 356059, 356132, 356645, 3595...
    └ <function save_img_and_todb at 0x00000140F5701C60>

  File "f:\k_grab1.9\main.py", line 117, in save_img_and_todb
    df_tags.to_sql(tags_table, engine, if_exists="append", index=False)
    │       │      │           └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>
    │       │      └ 'tags'
    │       └ <function NDFrame.to_sql at 0x00000140F2CA13F0>
    └              tag
      0      aqua_eyes
      1           topu
      2       ponytail
      3          white
      4           wink
      ..           ...
      168   ...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\core\generic.py", line 2987, in to_sql
    return sql.to_sql(
           │   └ <function to_sql at 0x00000140F4002CB0>
           └ <module 'pandas.io.sql' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pandas\\io\\sql....

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
           │          └ <function SQLDatabase.to_sql at 0x00000140F4024160>
           └ <pandas.io.sql.SQLDatabase object at 0x00000140F5CBDF60>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1728, in to_sql
    table = self.prep_table(
            │    └ <function SQLDatabase.prep_table at 0x00000140F4024040>
            └ <pandas.io.sql.SQLDatabase object at 0x00000140F5CBDF60>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 1631, in prep_table
    table.create()
    │     └ <function SQLTable.create at 0x00000140F4003130>
    └ <pandas.io.sql.SQLTable object at 0x00000140F9F2AC20>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 838, in create
    self._execute_create()
    │    └ <function SQLTable._execute_create at 0x00000140F40030A0>
    └ <pandas.io.sql.SQLTable object at 0x00000140F9F2AC20>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pandas\io\sql.py", line 824, in _execute_create
    self.table.create(bind=self.pd_sql.connectable)
    │    │     │           │    │      └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>
    │    │     │           │    └ <pandas.io.sql.SQLDatabase object at 0x00000140F5CBDF60>
    │    │     │           └ <pandas.io.sql.SQLTable object at 0x00000140F9F2AC20>
    │    │     └ <function Table.create at 0x00000140DB0ADFC0>
    │    └ Table('tags', MetaData(), Column('tag', Text(), table=<tags>), schema=None)
    └ <pandas.io.sql.SQLTable object at 0x00000140F9F2AC20>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\schema.py", line 960, in create
    bind._run_ddl_visitor(ddl.SchemaGenerator, self, checkfirst=checkfirst)
    │    │                │   │                │                └ False
    │    │                │   │                └ Table('tags', MetaData(), Column('tag', Text(), table=<tags>), schema=None)
    │    │                │   └ <class 'sqlalchemy.sql.ddl.SchemaGenerator'>
    │    │                └ <module 'sqlalchemy.sql.ddl' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\...
    │    └ <function Connection._run_ddl_visitor at 0x00000140DB166CB0>
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2211, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
    │               │    │        │       │                       └ Table('tags', MetaData(), Column('tag', Text(), table=<tags>), schema=None)
    │               │    │        │       └ {'checkfirst': False}
    │               │    │        └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>
    │               │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000140F5B64E20>
    │               └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>
    └ <class 'sqlalchemy.sql.ddl.SchemaGenerator'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
           │    │      └ {}
           │    └ Table('tags', MetaData(), Column('tag', Text(), table=<tags>), schema=None)
           └ <bound method SchemaGenerator.visit_table of <sqlalchemy.sql.ddl.SchemaGenerator object at 0x00000140F5C3B670>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\ddl.py", line 895, in visit_table
    self.connection.execute(
    │    │          └ <function Connection.execute at 0x00000140DB166440>
    │    └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>
    └ <sqlalchemy.sql.ddl.SchemaGenerator object at 0x00000140F5C3B670>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           │    │     │            │       └ immutabledict({})
           │    │     │            └ {}
           │    │     └ ()
           │    └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>
           └ <bound method DDLElement._execute_on_connection of <sqlalchemy.sql.ddl.CreateTable object at 0x00000140F6EB3580>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
           │          └ <function Connection._execute_ddl at 0x00000140DB1665F0>
           └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1472, in _execute_ddl
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x00000140DB1669E0>
          └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x00000140DB166B90>
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x00000140DA917AC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000140DB20FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000140F5B64E20>
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ '\nCREATE TABLE tags (\n\ttag TEXT\n)\n\n'
    │      └ <function Cursor.execute at 0x00000140F5C40280>
    └ <pymysql.cursors.Cursor object at 0x00000140F6EB14B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ '\nCREATE TABLE tags (\n\ttag TEXT\n)\n\n'
             │    └ <function Cursor._query at 0x00000140F5C40700>
             └ <pymysql.cursors.Cursor object at 0x00000140F6EB14B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ '\nCREATE TABLE tags (\n\ttag TEXT\n)\n\n'
    │    └ <function Connection.query at 0x00000140F5C436D0>
    └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x00000140F5C43D00>
    │    │                └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x00000140F5C48550>
    └ <pymysql.connections.MySQLResult object at 0x00000140F6EB2A70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x00000140F6EB2A70>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 692, in _read_packet
    packet_header = self._read_bytes(4)
                    │    └ <function Connection._read_bytes at 0x00000140F5C43BE0>
                    └ <pymysql.connections.Connection object at 0x00000140F5C3A9B0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 738, in _read_bytes
    raise err.OperationalError(
          │   └ <class 'pymysql.err.OperationalError'>
          └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query ([WinError 10054] 远程主机强迫关闭了一个现有的连接。)')
[SQL: 
CREATE TABLE tags (
	tag TEXT
)

]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-08-28 22:02:56.038 | SUCCESS  | __main__:mode_a:253 - totally DataBase had added 0 img data....
2023-08-28 22:02:56.039 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 22:03:04.165 | ERROR    | __main__:mode_a:204 - An error has been caught in function 'mode_a', process 'MainProcess' (11608), thread 'MainThread' (45968):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 613, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000140D8CFAE60>
           └ <module 'socket' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\socket.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\socket.py", line 845, in create_connection
    raise err
          └ None

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\socket.py", line 833, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3306)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0>

ConnectionRefusedError: [WinError 10061] 由于目标计算机积极拒绝，无法连接。


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           └ <bound method Pool.connect of <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 320, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x00000140DB194AF0>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 884, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x00000140DB1941F0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 486, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x00000140DB197250>
          └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x00000140DA917AC0>
    └ <module 'sqlalchemy.util.compat' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalch...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x00000140DB177910>
           └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 266, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 381, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000140F6F0FA90>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 677, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x00000140DA917AC0>
    └ <module 'sqlalchemy.util.compat' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalch...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 673, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000140F6F0FA90>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000140F9F2D2D0>
    │    │                               └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
    │    └ None
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000140F6F0FA90>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'database': 'testdb', 'user': 'root', 'password': '778899vvbbnnmm', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x00000140DB20F370>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000140F6F0F220>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           │    │     │        │        └ {'host': 'localhost', 'database': 'testdb', 'user': 'root', 'password': '778899vvbbnnmm', 'client_flag': 2}
           │    │     │        └ ()
           │    │     └ <class 'pymysql.connections.Connection'>
           │    └ <module 'pymysql' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\__init__.py'>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000140F6F0F220>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 353, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000140F5C43A30>
    └ <pymysql.connections.Connection object at 0x00000140F6F0EC50>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 664, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 313, in <module>
    mode_a()
    └ <function mode_a at 0x00000140F5701FC0>

> File "f:\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
    │       │                        └ <function link_db at 0x00000140F5701900>
    │       └ 'kimg'
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>

  File "f:\k_grab1.9\main.py", line 55, in link_db
    raise e

  File "f:\k_grab1.9\main.py", line 41, in link_db
    engine = engine.connect()
             │      └ <function Engine.connect at 0x00000140DB16E170>
             └ Engine(mysql+pymysql://root:***@localhost/testdb)

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           │    │               │                       └ False
           │    │               └ Engine(mysql+pymysql://root:***@localhost/testdb)
           │    └ <class 'sqlalchemy.engine.base.Connection'>
           └ Engine(mysql+pymysql://root:***@localhost/testdb)

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         │      └ <function Engine.raw_connection at 0x00000140DB16E5F0>
         └ Engine(mysql+pymysql://root:***@localhost/testdb)

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           │    │                  │    │    │        └ None
           │    │                  │    │    └ <function Pool.connect at 0x00000140DB177B50>
           │    │                  │    └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
           │    │                  └ Engine(mysql+pymysql://root:***@localhost/testdb)
           │    └ <function Engine._wrap_pool_connect at 0x00000140DB16E200>
           └ Engine(mysql+pymysql://root:***@localhost/testdb)

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
    │          └ <classmethod(<function Connection._handle_dbapi_exception_noconnection at 0x00000140DB166C20>)>
    └ <class 'sqlalchemy.engine.base.Connection'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
    │    └ <function raise_ at 0x00000140DA917AC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           └ <bound method Pool.connect of <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 320, in connect
    return _ConnectionFairy._checkout(self)
           │                │         └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
           │                └ <classmethod(<function _ConnectionFairy._checkout at 0x00000140DB194AF0>)>
           └ <class 'sqlalchemy.pool.base._ConnectionFairy'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 884, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            │                 │        └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
            │                 └ <classmethod(<function _ConnectionRecord.checkout at 0x00000140DB1941F0>)>
            └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 486, in checkout
    rec = pool._do_get()
          │    └ <function QueuePool._do_get at 0x00000140DB197250>
          └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x00000140DA917AC0>
    └ <module 'sqlalchemy.util.compat' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalch...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           │    └ <function Pool._create_connection at 0x00000140DB177910>
           └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 266, in _create_connection
    return _ConnectionRecord(self)
           │                 └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
           └ <class 'sqlalchemy.pool.base._ConnectionRecord'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 381, in __init__
    self.__connect()
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000140F6F0FA90>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 677, in __connect
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
    │      └ <function raise_ at 0x00000140DA917AC0>
    └ <module 'sqlalchemy.util.compat' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalch...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\pool\base.py", line 673, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
    │    │                               │    │               └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000140F6F0FA90>
    │    │                               │    └ <function create_engine.<locals>.connect at 0x00000140F9F2D2D0>
    │    │                               └ <sqlalchemy.pool.impl.QueuePool object at 0x00000140F6F0F0A0>
    │    └ None
    └ <sqlalchemy.pool.base._ConnectionRecord object at 0x00000140F6F0FA90>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           │       │        │        └ {'host': 'localhost', 'database': 'testdb', 'user': 'root', 'password': '778899vvbbnnmm', 'client_flag': 2}
           │       │        └ []
           │       └ <function DefaultDialect.connect at 0x00000140DB20F370>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000140F6F0F220>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           │    │     │        │        └ {'host': 'localhost', 'database': 'testdb', 'user': 'root', 'password': '778899vvbbnnmm', 'client_flag': 2}
           │    │     │        └ ()
           │    │     └ <class 'pymysql.connections.Connection'>
           │    └ <module 'pymysql' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\__init__.py'>
           └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000140F6F0F220>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 353, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000140F5C43A30>
    └ <pymysql.connections.Connection object at 0x00000140F6F0EC50>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 664, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")

sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-08-28 22:03:04.388 | ERROR    | __main__:mode_a:206 - 没有数据库连接,请检查数据库是否启用
2023-08-28 22:03:42.599 | ERROR    | __main__:<module>:313 - An error has been caught in function '<module>', process 'MainProcess' (11608), thread 'MainThread' (45968):
Traceback (most recent call last):

> File "f:\k_grab1.9\main.py", line 313, in <module>
    mode_a()
    └ <function mode_a at 0x00000140F5701FC0>

  File "f:\k_grab1.9\main.py", line 208, in mode_a
    raise e

  File "f:\k_grab1.9\main.py", line 204, in mode_a
    engine, kimg_table, tags_table = link_db()
    │       │                        └ <function link_db at 0x00000140F5701900>
    │       └ 'kimg'
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F5B64D30>

TypeError: cannot unpack non-iterable NoneType object
2023-08-28 22:03:42.611 | SUCCESS  | __main__:<module>:322 - 下载任务完成
2023-08-28 22:06:41.020 | INFO     | __main__:<module>:295 - 获取headers.......
2023-08-28 22:06:41.022 | INFO     | __main__:<module>:308 - 自动获取headers.......
2023-08-28 22:06:41.550 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 22:06:41.930 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 22:06:50.849 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 22:06:51.080 | SUCCESS  | __main__:<module>:311 - 获取headers成功......
2023-08-28 22:06:51.083 | SUCCESS  | __main__:mode_a:197 - 单次下载数量:20
2023-08-28 22:06:51.085 | SUCCESS  | __main__:mode_a:198 - 并发数:20
2023-08-28 22:06:51.086 | SUCCESS  | __main__:mode_a:199 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 22:06:51.089 | SUCCESS  | __main__:mode_a:200 - 下载次数:200
2023-08-28 22:06:51.091 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 22:06:51.317 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 22:06:51.320 | SUCCESS  | __main__:link_db:50 - 图像数据表: kimg
2023-08-28 22:06:51.322 | SUCCESS  | __main__:link_db:51 - tag数据表: tags
2023-08-28 22:06:51.324 | SUCCESS  | __main__:link_db:53 - link dbas 准备导入数据.....
2023-08-28 22:06:51.342 | WARNING  | __main__:mode_a:220 - 无法从kimg找到pid
2023-08-28 22:06:51.345 | INFO     | __main__:mode_a:224 - 数据库共有0条图像数据
2023-08-28 22:06:53.220 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.234 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.393 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.529 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.707 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.745 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.776 | ERROR    | cellfunctions_:get_source:136 - 356445图片不存在或者被删除了
2023-08-28 22:06:53.779 | ERROR    | cellfunctions_:get_source:137 - https://konachan.com/post/show/356445/
2023-08-28 22:06:53.791 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.845 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.865 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:53.928 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:54.012 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:54.436 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:54.527 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:54.742 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:54.863 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:54.923 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:55.034 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:06:55.659 | ERROR    | cellfunctions_:get_source:136 - 357857图片不存在或者被删除了
2023-08-28 22:06:55.661 | ERROR    | cellfunctions_:get_source:137 - https://konachan.com/post/show/357857/
2023-08-28 22:06:55.949 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:07:07.029 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360776
2023-08-28 22:07:07.032 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:07.275 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359020
2023-08-28 22:07:07.277 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:07.791 | INFO     | cellfunctions_:save_img:243 - 保存图片中......357191
2023-08-28 22:07:07.795 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:08.084 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361006
2023-08-28 22:07:08.087 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:08.147 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360784
2023-08-28 22:07:08.151 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:08.241 | INFO     | cellfunctions_:save_img:243 - 保存图片中......356555
2023-08-28 22:07:08.244 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:08.258 | INFO     | cellfunctions_:save_img:243 - 保存图片中......355030
2023-08-28 22:07:08.261 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:08.578 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360756
2023-08-28 22:07:08.580 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:09.795 | INFO     | cellfunctions_:save_img:243 - 保存图片中......356019
2023-08-28 22:07:09.799 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:09.947 | INFO     | cellfunctions_:save_img:243 - 保存图片中......358374
2023-08-28 22:07:09.950 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:10.447 | INFO     | cellfunctions_:save_img:243 - 保存图片中......357313
2023-08-28 22:07:10.451 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:10.510 | INFO     | cellfunctions_:save_img:243 - 保存图片中......356620
2023-08-28 22:07:10.514 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:11.165 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359062
2023-08-28 22:07:11.170 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:11.236 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361431
2023-08-28 22:07:11.244 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:11.437 | INFO     | cellfunctions_:save_img:243 - 保存图片中......357549
2023-08-28 22:07:11.441 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:21.053 | INFO     | cellfunctions_:save_img:243 - 保存图片中......355070
2023-08-28 22:07:21.056 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:07:27.276 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361187
2023-08-28 22:07:27.280 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:09.185 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360383
2023-08-28 22:09:09.189 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:09.192 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 18 img to IMG_PATH......
2023-08-28 22:09:09.200 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\357313.jpg
2023-08-28 22:09:09.207 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\357191.jpg
2023-08-28 22:09:09.213 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\356555.jpg
2023-08-28 22:09:09.219 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360776.jpg
2023-08-28 22:09:09.224 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\356620.jpg
2023-08-28 22:09:09.230 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360784.jpg
2023-08-28 22:09:09.236 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\355030.jpg
2023-08-28 22:09:09.241 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\361431.jpg
2023-08-28 22:09:09.247 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\359062.jpg
2023-08-28 22:09:09.252 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\361187.jpg
2023-08-28 22:09:09.257 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\358374.jpg
2023-08-28 22:09:09.263 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\359020.jpg
2023-08-28 22:09:09.268 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\357549.jpg
2023-08-28 22:09:09.273 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\361006.jpg
2023-08-28 22:09:09.279 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\356019.jpg
2023-08-28 22:09:09.283 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360756.jpg
2023-08-28 22:09:09.289 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\355070.jpg
2023-08-28 22:09:09.294 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360383.jpg
2023-08-28 22:09:09.637 | SUCCESS  | __main__:save_img_and_todb:161 - DataBase had added 18 img data...
2023-08-28 22:09:09.639 | SUCCESS  | __main__:mode_a:255 - totally DataBase had added 18 img data....
2023-08-28 22:09:09.641 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 22:09:09.649 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 22:09:09.651 | SUCCESS  | __main__:link_db:50 - 图像数据表: kimg
2023-08-28 22:09:09.652 | SUCCESS  | __main__:link_db:51 - tag数据表: tags
2023-08-28 22:09:09.654 | SUCCESS  | __main__:link_db:53 - link dbas 准备导入数据.....
2023-08-28 22:09:09.664 | INFO     | __main__:mode_a:224 - 数据库共有18条图像数据
2023-08-28 22:09:11.478 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:11.530 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:11.613 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:11.701 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:11.712 | ERROR    | cellfunctions_:get_source:136 - 356157图片不存在或者被删除了
2023-08-28 22:09:11.714 | ERROR    | cellfunctions_:get_source:137 - https://konachan.com/post/show/356157/
2023-08-28 22:09:11.817 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:11.889 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:11.943 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.006 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.023 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.249 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.265 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.570 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.675 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.682 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.765 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:12.896 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:13.802 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:14.452 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:14.543 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:09:25.415 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361632
2023-08-28 22:09:25.419 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:25.638 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359383
2023-08-28 22:09:25.641 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:26.377 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360717
2023-08-28 22:09:26.380 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:26.505 | INFO     | cellfunctions_:save_img:243 - 保存图片中......355156
2023-08-28 22:09:26.508 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:27.164 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359087
2023-08-28 22:09:27.167 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:27.431 | INFO     | cellfunctions_:save_img:243 - 保存图片中......358794
2023-08-28 22:09:27.447 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:27.603 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360841
2023-08-28 22:09:27.607 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:27.797 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360604
2023-08-28 22:09:27.800 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:28.054 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361502
2023-08-28 22:09:28.057 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:28.584 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360286
2023-08-28 22:09:28.587 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:28.803 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361313
2023-08-28 22:09:28.806 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:29.031 | INFO     | cellfunctions_:save_img:243 - 保存图片中......356699
2023-08-28 22:09:29.035 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:29.658 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359735
2023-08-28 22:09:29.662 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:31.140 | INFO     | cellfunctions_:save_img:243 - 保存图片中......361804
2023-08-28 22:09:31.157 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:31.225 | INFO     | cellfunctions_:save_img:243 - 保存图片中......359299
2023-08-28 22:09:31.228 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:31.238 | INFO     | cellfunctions_:save_img:243 - 保存图片中......357144
2023-08-28 22:09:31.240 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:32.464 | INFO     | cellfunctions_:save_img:243 - 保存图片中......360923
2023-08-28 22:09:32.467 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:09:49.427 | INFO     | cellfunctions_:save_img:243 - 保存图片中......358485
2023-08-28 22:09:49.436 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:10:11.893 | INFO     | cellfunctions_:save_img:243 - 保存图片中......356985
2023-08-28 22:10:11.897 | SUCCESS  | cellfunctions_:save_img:259 - 下载图片成功
2023-08-28 22:10:11.899 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 19 img to IMG_PATH......
2023-08-28 22:10:11.906 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\359299.jpg
2023-08-28 22:10:11.912 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360841.jpg
2023-08-28 22:10:11.918 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\358794.jpg
2023-08-28 22:10:11.925 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360717.jpg
2023-08-28 22:10:11.930 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\357144.jpg
2023-08-28 22:10:11.937 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360604.jpg
2023-08-28 22:10:11.942 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\361502.jpg
2023-08-28 22:10:11.949 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\361632.jpg
2023-08-28 22:10:11.955 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\359087.jpg
2023-08-28 22:10:11.962 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\359735.jpg
2023-08-28 22:10:11.968 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\361804.jpg
2023-08-28 22:10:11.974 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\355156.jpg
2023-08-28 22:10:11.980 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\358485.jpg
2023-08-28 22:10:11.987 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\359383.jpg
2023-08-28 22:10:11.995 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360923.jpg
2023-08-28 22:10:12.002 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\356699.jpg
2023-08-28 22:10:12.008 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\360286.jpg
2023-08-28 22:10:12.013 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\361313.jpg
2023-08-28 22:10:12.020 | SUCCESS  | __main__:save_img_and_todb:106 - imported: F:\database_learn\k_spider\pictures10\356985.jpg
2023-08-28 22:10:12.148 | SUCCESS  | __main__:save_img_and_todb:161 - DataBase had added 19 img data...
2023-08-28 22:10:12.156 | SUCCESS  | __main__:mode_a:255 - totally DataBase had added 37 img data....
2023-08-28 22:10:12.158 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 22:10:12.182 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 22:10:12.194 | SUCCESS  | __main__:link_db:50 - 图像数据表: kimg
2023-08-28 22:10:12.196 | SUCCESS  | __main__:link_db:51 - tag数据表: tags
2023-08-28 22:10:12.201 | SUCCESS  | __main__:link_db:53 - link dbas 准备导入数据.....
2023-08-28 22:10:12.212 | INFO     | __main__:mode_a:224 - 数据库共有37条图像数据
2023-08-28 22:10:13.820 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:13.917 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.039 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.094 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.102 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.112 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.145 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.174 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.206 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.356 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.471 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.530 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.645 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:14.830 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:10:15.016 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 22:57:14.961 | INFO     | __main__:<module>:306 - 尝试从headers_firefox.json获取headers.......
2023-08-28 22:57:14.967 | WARNING  | __main__:<module>:319 - 失败,将自动获取headers.......
2023-08-28 22:57:15.517 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 22:57:15.950 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 22:57:23.963 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 22:57:24.244 | SUCCESS  | __main__:<module>:322 - 获取headers成功......
2023-08-28 22:57:24.247 | ERROR    | __main__:<module>:326 - An error has been caught in function '<module>', process 'MainProcess' (34592), thread 'MainThread' (19184):
Traceback (most recent call last):

> File "f:\k_grab1.9\main.py", line 326, in <module>
    mode_a()
    └ <function mode_a at 0x0000024A3D6B1E10>

  File "f:\k_grab1.9\main.py", line 207, in mode_a
    raise e

  File "f:\k_grab1.9\main.py", line 190, in mode_a
    down_total_add_db_data_number = int(down_total_add_db_data_number)
                                        └ None

TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2023-08-28 22:57:24.265 | SUCCESS  | __main__:<module>:337 - 下载任务完成
2023-08-28 23:01:16.692 | INFO     | __main__:<module>:306 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:01:16.697 | WARNING  | __main__:<module>:319 - 失败,将自动获取headers.......
2023-08-28 23:01:17.203 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:01:17.600 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:01:24.036 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:01:24.251 | SUCCESS  | __main__:<module>:322 - 获取headers成功......
2023-08-28 23:01:24.253 | SUCCESS  | __main__:mode_a:209 - 单次下载数量:20
2023-08-28 23:01:24.255 | SUCCESS  | __main__:mode_a:210 - 并发数:20
2023-08-28 23:01:24.256 | SUCCESS  | __main__:mode_a:211 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:01:24.257 | SUCCESS  | __main__:mode_a:212 - 下载次数:200
2023-08-28 23:01:24.259 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:01:24.489 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:01:24.492 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:01:24.494 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:01:24.496 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:01:24.515 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:01:26.409 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.451 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.480 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.493 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.534 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.556 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.649 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.782 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.797 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.849 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:26.975 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:27.123 | ERROR    | cellfunctions_:get_source:136 - 357649图片不存在或者被删除了
2023-08-28 23:01:27.124 | ERROR    | cellfunctions_:get_source:137 - https://konachan.com/post/show/357649/
2023-08-28 23:01:27.194 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:27.203 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:27.505 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:27.567 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:28.250 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:28.533 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:28.956 | ERROR    | cellfunctions_:get_source:136 - 359235图片不存在或者被删除了
2023-08-28 23:01:28.959 | ERROR    | cellfunctions_:get_source:137 - https://konachan.com/post/show/359235/
2023-08-28 23:01:29.323 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:01:41.439 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359129
2023-08-28 23:01:41.442 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:41.632 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361859
2023-08-28 23:01:41.636 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:41.812 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361275
2023-08-28 23:01:41.814 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:41.948 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361199
2023-08-28 23:01:41.952 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:42.073 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359447
2023-08-28 23:01:42.075 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:45.282 | INFO     | cellfunctions_:save_img:242 - 保存图片中......360238
2023-08-28 23:01:45.285 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:45.457 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357539
2023-08-28 23:01:45.461 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:45.629 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361537
2023-08-28 23:01:45.633 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:45.814 | INFO     | cellfunctions_:save_img:242 - 保存图片中......355654
2023-08-28 23:01:45.818 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:46.016 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357016
2023-08-28 23:01:46.020 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:46.253 | INFO     | cellfunctions_:save_img:242 - 保存图片中......356919
2023-08-28 23:01:46.255 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:46.752 | INFO     | cellfunctions_:save_img:242 - 保存图片中......355338
2023-08-28 23:01:46.755 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:46.801 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357568
2023-08-28 23:01:46.804 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:47.945 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359282
2023-08-28 23:01:47.962 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:01:48.197 | INFO     | cellfunctions_:save_img:242 - 保存图片中......355684
2023-08-28 23:01:48.201 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:02:07.103 | INFO     | cellfunctions_:save_img:242 - 保存图片中......360653
2023-08-28 23:02:07.107 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:02:07.333 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357835
2023-08-28 23:02:07.338 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:03:09.256 | INFO     | cellfunctions_:save_img:242 - 保存图片中......358431
2023-08-28 23:03:09.259 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:03:09.262 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 18 img to IMG_PATH......
2023-08-28 23:03:09.268 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\361859.jpg
2023-08-28 23:03:09.272 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\355338.jpg
2023-08-28 23:03:09.276 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359447.jpg
2023-08-28 23:03:09.280 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\358431.jpg
2023-08-28 23:03:09.284 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357016.jpg
2023-08-28 23:03:09.288 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\360238.jpg
2023-08-28 23:03:09.294 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357539.jpg
2023-08-28 23:03:09.303 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\356919.jpg
2023-08-28 23:03:09.313 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\361275.jpg
2023-08-28 23:03:09.318 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357568.jpg
2023-08-28 23:03:09.323 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\361537.jpg
2023-08-28 23:03:09.329 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\355654.jpg
2023-08-28 23:03:09.334 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357835.jpg
2023-08-28 23:03:09.341 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\360653.jpg
2023-08-28 23:03:09.346 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359129.jpg
2023-08-28 23:03:09.352 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\355684.jpg
2023-08-28 23:03:09.357 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\361199.jpg
2023-08-28 23:03:09.363 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359282.jpg
2023-08-28 23:03:18.431 | ERROR    | __main__:mode_a:265 - An error has been caught in function 'mode_a', process 'MainProcess' (26440), thread 'MainThread' (43256):
Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 326, in <module>
    mode_a()
    └ <function mode_a at 0x000001D71B6F1E10>

> File "f:\k_grab1.9\main.py", line 265, in mode_a
    save_img_and_todb(pids, engine, kimg_table, tags_table)
    │                 │     │       │           └ 'tags'
    │                 │     │       └ 'kimg'
    │                 │     └ <sqlalchemy.engine.base.Connection object at 0x000001D71BB58B80>
    │                 └ [361859, 355338, 357649, 359447, 357016, 358431, 357539, 360238, 356919, 361275, 357568, 361537, 359235, 355654, 357835, 3606...
    └ <function save_img_and_todb at 0x000001D71B6F1AB0>

  File "f:\k_grab1.9\main.py", line 149, in save_img_and_todb
    engine.excute(
    └ <sqlalchemy.engine.base.Connection object at 0x000001D71BB58B80>

AttributeError: 'Connection' object has no attribute 'excute'. Did you mean: 'execute'?
2023-08-28 23:03:18.449 | SUCCESS  | __main__:mode_a:267 - 数据库一共添加了 0 img data....
2023-08-28 23:03:18.450 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:03:18.457 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:03:18.458 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:03:18.460 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:03:18.461 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:03:18.471 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:03:20.045 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:20.077 | ERROR    | cellfunctions_:get_source:136 - 360611图片不存在或者被删除了
2023-08-28 23:03:20.080 | ERROR    | cellfunctions_:get_source:137 - https://konachan.com/post/show/360611/
2023-08-28 23:03:20.165 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:20.212 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:20.303 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:20.330 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:20.514 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:20.747 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:20.843 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:20.962 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:21.053 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:21.127 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:21.150 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:21.285 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:21.574 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:21.779 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:21.854 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:21.890 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:23.240 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:03:24.125 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:04:07.584 | INFO     | __main__:<module>:306 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:04:07.586 | WARNING  | __main__:<module>:319 - 失败,将自动获取headers.......
2023-08-28 23:05:01.082 | INFO     | __main__:<module>:306 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:05:01.091 | WARNING  | __main__:<module>:319 - 失败,将自动获取headers.......
2023-08-28 23:05:01.632 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:05:02.055 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:05:07.810 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:05:07.853 | SUCCESS  | __main__:<module>:322 - 获取headers成功......
2023-08-28 23:05:07.855 | SUCCESS  | __main__:mode_a:209 - 单次下载数量:5
2023-08-28 23:05:07.855 | SUCCESS  | __main__:mode_a:210 - 并发数:5
2023-08-28 23:05:07.857 | SUCCESS  | __main__:mode_a:211 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:05:07.859 | SUCCESS  | __main__:mode_a:212 - 下载次数:200
2023-08-28 23:05:07.861 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:05:07.980 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:05:07.983 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:05:07.984 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:05:07.986 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:05:08.005 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:05:09.809 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:05:09.839 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:05:10.133 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:05:10.159 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:05:10.752 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:05:17.383 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359777
2023-08-28 23:05:17.386 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:05:17.987 | INFO     | cellfunctions_:save_img:242 - 保存图片中......355689
2023-08-28 23:05:17.991 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:05:19.194 | INFO     | cellfunctions_:save_img:242 - 保存图片中......356325
2023-08-28 23:05:19.201 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:05:33.247 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359027
2023-08-28 23:05:33.250 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:06:33.249 | INFO     | cellfunctions_:save_img:242 - 保存图片中......358290
2023-08-28 23:06:33.253 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:06:33.255 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 5 img to IMG_PATH......
2023-08-28 23:06:33.260 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359777.jpg
2023-08-28 23:06:33.265 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\356325.jpg
2023-08-28 23:06:33.270 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\355689.jpg
2023-08-28 23:06:33.275 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\358290.jpg
2023-08-28 23:06:33.279 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359027.jpg
2023-08-28 23:06:42.933 | ERROR    | __main__:mode_a:265 - An error has been caught in function 'mode_a', process 'MainProcess' (11928), thread 'MainThread' (19528):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000219A221FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000219BCB26CE0>
    └ <sqlalchemy.engine.base.Connection object at 0x00000219BCB27BE0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'DROP TABLE if EXISTS tags_unique;\n    CREATE TABLE if not EXISTS tags_unique LIKE tags;\n    INSERT into tags_unique SELECT...
    │      └ <function Cursor.execute at 0x00000219BCBA9EA0>
    └ <pymysql.cursors.Cursor object at 0x00000219BF282E00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'DROP TABLE if EXISTS tags_unique;\n    CREATE TABLE if not EXISTS tags_unique LIKE tags;\n    INSERT into tags_unique SELECT...
             │    └ <function Cursor._query at 0x00000219BCBAA320>
             └ <pymysql.cursors.Cursor object at 0x00000219BF282E00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'DROP TABLE if EXISTS tags_unique;\n    CREATE TABLE if not EXISTS tags_unique LIKE tags;\n    INSERT into tags_unique SELECT...
    │    └ <function Connection.query at 0x00000219BCC69360>
    └ <pymysql.connections.Connection object at 0x00000219BCC5CA00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x00000219BCC69990>
    │    │                └ <pymysql.connections.Connection object at 0x00000219BCC5CA00>
    │    └ 71
    └ <pymysql.connections.Connection object at 0x00000219BCC5CA00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x00000219BCC6A170>
    └ <pymysql.connections.MySQLResult object at 0x00000219BF282D40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x00000219BF282D40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x00000219BCBABF40>
    └ <pymysql.protocol.MysqlPacket object at 0x00000219BF282C80>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x00000219BF282C80>
    │   └ <function raise_mysql_exception at 0x00000219BC5FCF70>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to...
          │          └ 1064
          └ <class 'pymysql.err.ProgrammingError'>

pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE if not EXISTS tags_unique LIKE tags;\n    INSERT into tags_unique SE' at line 2")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 326, in <module>
    mode_a()
    └ <function mode_a at 0x00000219BC691E10>

> File "f:\k_grab1.9\main.py", line 265, in mode_a
    save_img_and_todb(pids, engine, kimg_table, tags_table)
    │                 │     │       │           └ 'tags'
    │                 │     │       └ 'kimg'
    │                 │     └ <sqlalchemy.engine.base.Connection object at 0x00000219BCB27BE0>
    │                 └ [359777, 356325, 355689, 358290, 359027]
    └ <function save_img_and_todb at 0x00000219BC691AB0>

  File "f:\k_grab1.9\main.py", line 149, in save_img_and_todb
    engine.execute(
    │      └ <function Connection.execute at 0x00000219A217A440>
    └ <sqlalchemy.engine.base.Connection object at 0x00000219BCB27BE0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           │    │     │            │       └ immutabledict({})
           │    │     │            └ {}
           │    │     └ ()
           │    └ <sqlalchemy.engine.base.Connection object at 0x00000219BCB27BE0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.elements.TextClause object at 0x00000219BCC5FCD0>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x00000219A217A710>
           └ <sqlalchemy.engine.base.Connection object at 0x00000219BCB27BE0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x00000219A217A9E0>
          └ <sqlalchemy.engine.base.Connection object at 0x00000219BCB27BE0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x00000219A217AB90>
    └ <sqlalchemy.engine.base.Connection object at 0x00000219BCB27BE0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x00000219A192BAC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000219A221FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x00000219BCB26CE0>
    └ <sqlalchemy.engine.base.Connection object at 0x00000219BCB27BE0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'DROP TABLE if EXISTS tags_unique;\n    CREATE TABLE if not EXISTS tags_unique LIKE tags;\n    INSERT into tags_unique SELECT...
    │      └ <function Cursor.execute at 0x00000219BCBA9EA0>
    └ <pymysql.cursors.Cursor object at 0x00000219BF282E00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'DROP TABLE if EXISTS tags_unique;\n    CREATE TABLE if not EXISTS tags_unique LIKE tags;\n    INSERT into tags_unique SELECT...
             │    └ <function Cursor._query at 0x00000219BCBAA320>
             └ <pymysql.cursors.Cursor object at 0x00000219BF282E00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'DROP TABLE if EXISTS tags_unique;\n    CREATE TABLE if not EXISTS tags_unique LIKE tags;\n    INSERT into tags_unique SELECT...
    │    └ <function Connection.query at 0x00000219BCC69360>
    └ <pymysql.connections.Connection object at 0x00000219BCC5CA00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x00000219BCC69990>
    │    │                └ <pymysql.connections.Connection object at 0x00000219BCC5CA00>
    │    └ 71
    └ <pymysql.connections.Connection object at 0x00000219BCC5CA00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x00000219BCC6A170>
    └ <pymysql.connections.MySQLResult object at 0x00000219BF282D40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x00000219BF282D40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x00000219BCBABF40>
    └ <pymysql.protocol.MysqlPacket object at 0x00000219BF282C80>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x00000219BF282C80>
    │   └ <function raise_mysql_exception at 0x00000219BC5FCF70>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to...
          │          └ 1064
          └ <class 'pymysql.err.ProgrammingError'>

sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE if not EXISTS tags_unique LIKE tags;\n    INSERT into tags_unique SE' at line 2")
[SQL: DROP TABLE if EXISTS tags_unique;
    CREATE TABLE if not EXISTS tags_unique LIKE tags;
    INSERT into tags_unique SELECT DISTINCT tag from tags;]
(Background on this error at: https://sqlalche.me/e/14/f405)
2023-08-28 23:06:43.097 | SUCCESS  | __main__:mode_a:267 - 数据库一共添加了 0 img data....
2023-08-28 23:06:43.100 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:06:43.108 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:06:43.110 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:06:43.112 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:06:43.114 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:06:43.125 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:06:44.242 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:06:44.280 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:06:45.104 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:06:45.393 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:06:47.080 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:08:16.536 | INFO     | __main__:<module>:306 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:08:16.538 | WARNING  | __main__:<module>:319 - 失败,将自动获取headers.......
2023-08-28 23:08:17.073 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:08:17.412 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:08:21.560 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:08:21.602 | SUCCESS  | __main__:<module>:322 - 获取headers成功......
2023-08-28 23:08:21.604 | SUCCESS  | __main__:mode_a:209 - 单次下载数量:5
2023-08-28 23:08:21.605 | SUCCESS  | __main__:mode_a:210 - 并发数:5
2023-08-28 23:08:21.606 | SUCCESS  | __main__:mode_a:211 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:08:21.608 | SUCCESS  | __main__:mode_a:212 - 下载次数:200
2023-08-28 23:08:21.609 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:08:21.741 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:08:21.742 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:08:21.744 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:08:21.745 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:08:21.762 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:08:23.394 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:08:23.488 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:08:23.927 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:08:24.051 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:08:24.201 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:08:30.848 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361346
2023-08-28 23:08:30.855 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:08:31.559 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357102
2023-08-28 23:08:31.562 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:08:39.546 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361601
2023-08-28 23:08:39.549 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:08:46.953 | INFO     | cellfunctions_:save_img:242 - 保存图片中......356914
2023-08-28 23:08:46.957 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:08:52.962 | INFO     | cellfunctions_:save_img:242 - 保存图片中......358148
2023-08-28 23:08:52.972 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:08:52.974 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 5 img to IMG_PATH......
2023-08-28 23:08:52.979 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\361601.jpg
2023-08-28 23:08:52.984 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\361346.jpg
2023-08-28 23:08:52.990 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\358148.jpg
2023-08-28 23:08:52.994 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357102.jpg
2023-08-28 23:08:53.002 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\356914.jpg
2023-08-28 23:08:58.470 | ERROR    | __main__:mode_a:265 - An error has been caught in function 'mode_a', process 'MainProcess' (36804), thread 'MainThread' (7208):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002595C10FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000025976A9EE90>
    └ <sqlalchemy.engine.base.Connection object at 0x0000025976A9E830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'DROP TABLE if EXISTS tags_unique;\n            CREATE TABLE if not EXISTS tags_unique LIKE tags;\n            INSERT into ta...
    │      └ <function Cursor.execute at 0x0000025976BCDEA0>
    └ <pymysql.cursors.Cursor object at 0x0000025977FAB940>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'DROP TABLE if EXISTS tags_unique;\n            CREATE TABLE if not EXISTS tags_unique LIKE tags;\n            INSERT into ta...
             │    └ <function Cursor._query at 0x0000025976BCE320>
             └ <pymysql.cursors.Cursor object at 0x0000025977FAB940>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'DROP TABLE if EXISTS tags_unique;\n            CREATE TABLE if not EXISTS tags_unique LIKE tags;\n            INSERT into ta...
    │    └ <function Connection.query at 0x0000025976BE9360>
    └ <pymysql.connections.Connection object at 0x0000025976BDD6C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x0000025976BE9990>
    │    │                └ <pymysql.connections.Connection object at 0x0000025976BDD6C0>
    │    └ 67
    └ <pymysql.connections.Connection object at 0x0000025976BDD6C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000025976BEA170>
    └ <pymysql.connections.MySQLResult object at 0x0000025977FAB8E0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000025977FAB8E0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x0000025976BCFF40>
    └ <pymysql.protocol.MysqlPacket object at 0x0000025977FAB7C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000025977FAB7C0>
    │   └ <function raise_mysql_exception at 0x000002597656CF70>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to...
          │          └ 1064
          └ <class 'pymysql.err.ProgrammingError'>

pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE if not EXISTS tags_unique LIKE tags;\n            INSERT into tags_u' at line 2")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 326, in <module>
    mode_a()
    └ <function mode_a at 0x0000025976601E10>

> File "f:\k_grab1.9\main.py", line 265, in mode_a
    save_img_and_todb(pids, engine, kimg_table, tags_table)
    │                 │     │       │           └ 'tags'
    │                 │     │       └ 'kimg'
    │                 │     └ <sqlalchemy.engine.base.Connection object at 0x0000025976A9E830>
    │                 └ [361601, 361346, 358148, 357102, 356914]
    └ <function save_img_and_todb at 0x0000025976601AB0>

  File "f:\k_grab1.9\main.py", line 149, in save_img_and_todb
    engine.execute(
    │      └ <function Connection.execute at 0x000002595C06A440>
    └ <sqlalchemy.engine.base.Connection object at 0x0000025976A9E830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           │    │     │            │       └ immutabledict({})
           │    │     │            └ {}
           │    │     └ ()
           │    └ <sqlalchemy.engine.base.Connection object at 0x0000025976A9E830>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.elements.TextClause object at 0x0000025976BDF250>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000002595C06A710>
           └ <sqlalchemy.engine.base.Connection object at 0x0000025976A9E830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000002595C06A9E0>
          └ <sqlalchemy.engine.base.Connection object at 0x0000025976A9E830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000002595C06AB90>
    └ <sqlalchemy.engine.base.Connection object at 0x0000025976A9E830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x000002595B81BAC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002595C10FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000025976A9EE90>
    └ <sqlalchemy.engine.base.Connection object at 0x0000025976A9E830>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'DROP TABLE if EXISTS tags_unique;\n            CREATE TABLE if not EXISTS tags_unique LIKE tags;\n            INSERT into ta...
    │      └ <function Cursor.execute at 0x0000025976BCDEA0>
    └ <pymysql.cursors.Cursor object at 0x0000025977FAB940>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'DROP TABLE if EXISTS tags_unique;\n            CREATE TABLE if not EXISTS tags_unique LIKE tags;\n            INSERT into ta...
             │    └ <function Cursor._query at 0x0000025976BCE320>
             └ <pymysql.cursors.Cursor object at 0x0000025977FAB940>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'DROP TABLE if EXISTS tags_unique;\n            CREATE TABLE if not EXISTS tags_unique LIKE tags;\n            INSERT into ta...
    │    └ <function Connection.query at 0x0000025976BE9360>
    └ <pymysql.connections.Connection object at 0x0000025976BDD6C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x0000025976BE9990>
    │    │                └ <pymysql.connections.Connection object at 0x0000025976BDD6C0>
    │    └ 67
    └ <pymysql.connections.Connection object at 0x0000025976BDD6C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000025976BEA170>
    └ <pymysql.connections.MySQLResult object at 0x0000025977FAB8E0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000025977FAB8E0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x0000025976BCFF40>
    └ <pymysql.protocol.MysqlPacket object at 0x0000025977FAB7C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000025977FAB7C0>
    │   └ <function raise_mysql_exception at 0x000002597656CF70>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to...
          │          └ 1064
          └ <class 'pymysql.err.ProgrammingError'>

sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE if not EXISTS tags_unique LIKE tags;\n            INSERT into tags_u' at line 2")
[SQL: DROP TABLE if EXISTS tags_unique;
            CREATE TABLE if not EXISTS tags_unique LIKE tags;
            INSERT into tags_unique SELECT DISTINCT tag from tags;]
(Background on this error at: https://sqlalche.me/e/14/f405)
2023-08-28 23:08:58.634 | SUCCESS  | __main__:mode_a:267 - 数据库一共添加了 0 img data....
2023-08-28 23:08:58.634 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:08:58.642 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:08:58.652 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:08:58.652 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:08:58.652 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:08:58.700 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:08:59.632 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:08:59.698 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:08:59.874 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:09:00.140 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:09:00.427 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:09:06.884 | INFO     | cellfunctions_:save_img:242 - 保存图片中......360192
2023-08-28 23:09:06.888 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:09:06.983 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359561
2023-08-28 23:09:06.985 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:09:07.030 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361041
2023-08-28 23:09:07.033 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:09:07.559 | INFO     | cellfunctions_:save_img:242 - 保存图片中......360698
2023-08-28 23:09:07.562 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:09:07.608 | INFO     | cellfunctions_:save_img:242 - 保存图片中......358116
2023-08-28 23:09:07.614 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:09:07.616 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 5 img to IMG_PATH......
2023-08-28 23:09:07.620 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\360192.jpg
2023-08-28 23:09:07.625 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\358116.jpg
2023-08-28 23:09:07.629 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\361041.jpg
2023-08-28 23:09:07.634 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359561.jpg
2023-08-28 23:09:07.638 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\360698.jpg
2023-08-28 23:10:59.778 | INFO     | __main__:<module>:306 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:10:59.780 | WARNING  | __main__:<module>:319 - 失败,将自动获取headers.......
2023-08-28 23:11:00.314 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:11:00.656 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:11:05.293 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:11:05.339 | SUCCESS  | __main__:<module>:322 - 获取headers成功......
2023-08-28 23:11:05.341 | SUCCESS  | __main__:mode_a:209 - 单次下载数量:3
2023-08-28 23:11:05.342 | SUCCESS  | __main__:mode_a:210 - 并发数:5
2023-08-28 23:11:05.344 | SUCCESS  | __main__:mode_a:211 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:11:05.346 | SUCCESS  | __main__:mode_a:212 - 下载次数:200
2023-08-28 23:11:05.348 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:11:05.582 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:11:05.586 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:11:05.587 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:11:05.589 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:11:05.607 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:11:07.963 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:11:07.966 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:11:08.208 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:11:14.434 | INFO     | cellfunctions_:save_img:242 - 保存图片中......358648
2023-08-28 23:11:14.443 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:11:14.534 | INFO     | cellfunctions_:save_img:242 - 保存图片中......355541
2023-08-28 23:11:14.537 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:11:46.452 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357892
2023-08-28 23:11:46.455 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:11:46.457 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 3 img to IMG_PATH......
2023-08-28 23:11:46.462 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\358648.jpg
2023-08-28 23:11:46.469 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357892.jpg
2023-08-28 23:11:46.474 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\355541.jpg
2023-08-28 23:11:46.523 | ERROR    | __main__:mode_a:265 - An error has been caught in function 'mode_a', process 'MainProcess' (27656), thread 'MainThread' (48776):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000024D19C1FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000024D34576800>
    └ <sqlalchemy.engine.base.Connection object at 0x0000024D34576020>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
    │      └ <function Cursor.execute at 0x0000024D3462C0D0>
    └ <pymysql.cursors.Cursor object at 0x0000024D347CBF40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
             │    └ <function Cursor._query at 0x0000024D3462C550>
             └ <pymysql.cursors.Cursor object at 0x0000024D347CBF40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
    │    └ <function Connection.query at 0x0000024D3462F520>
    └ <pymysql.connections.Connection object at 0x0000024D34622560>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x0000024D3462FB50>
    │    │                └ <pymysql.connections.Connection object at 0x0000024D34622560>
    │    └ 43
    └ <pymysql.connections.Connection object at 0x0000024D34622560>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000024D346343A0>
    └ <pymysql.connections.MySQLResult object at 0x0000024D347CBDC0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000024D347CBDC0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x0000024D3462E170>
    └ <pymysql.protocol.MysqlPacket object at 0x0000024D347C8B80>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000024D347C8B80>
    │   └ <function raise_mysql_exception at 0x0000024D344D3BE0>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to...
          │          └ 1064
          └ <class 'pymysql.err.ProgrammingError'>

pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT ' at line 1")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 326, in <module>
    mode_a()
    └ <function mode_a at 0x0000024D34111E10>

> File "f:\k_grab1.9\main.py", line 265, in mode_a
    save_img_and_todb(pids, engine, kimg_table, tags_table)
    │                 │     │       │           └ 'tags'
    │                 │     │       └ 'kimg'
    │                 │     └ <sqlalchemy.engine.base.Connection object at 0x0000024D34576020>
    │                 └ [358648, 357892, 355541]
    └ <function save_img_and_todb at 0x0000024D34111AB0>

  File "f:\k_grab1.9\main.py", line 149, in save_img_and_todb
    engine.execute(
    │      └ <function Connection.execute at 0x0000024D19B7A440>
    └ <sqlalchemy.engine.base.Connection object at 0x0000024D34576020>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           │    │     │            │       └ immutabledict({})
           │    │     │            └ {}
           │    │     └ ()
           │    └ <sqlalchemy.engine.base.Connection object at 0x0000024D34576020>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.elements.TextClause object at 0x0000024D34623CA0>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000024D19B7A710>
           └ <sqlalchemy.engine.base.Connection object at 0x0000024D34576020>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000024D19B7A9E0>
          └ <sqlalchemy.engine.base.Connection object at 0x0000024D34576020>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000024D19B7AB90>
    └ <sqlalchemy.engine.base.Connection object at 0x0000024D34576020>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x0000024D1932BAC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000024D19C1FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000024D34576800>
    └ <sqlalchemy.engine.base.Connection object at 0x0000024D34576020>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
    │      └ <function Cursor.execute at 0x0000024D3462C0D0>
    └ <pymysql.cursors.Cursor object at 0x0000024D347CBF40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
             │    └ <function Cursor._query at 0x0000024D3462C550>
             └ <pymysql.cursors.Cursor object at 0x0000024D347CBF40>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
    │    └ <function Connection.query at 0x0000024D3462F520>
    └ <pymysql.connections.Connection object at 0x0000024D34622560>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x0000024D3462FB50>
    │    │                └ <pymysql.connections.Connection object at 0x0000024D34622560>
    │    └ 43
    └ <pymysql.connections.Connection object at 0x0000024D34622560>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000024D346343A0>
    └ <pymysql.connections.MySQLResult object at 0x0000024D347CBDC0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000024D347CBDC0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x0000024D3462E170>
    └ <pymysql.protocol.MysqlPacket object at 0x0000024D347C8B80>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000024D347C8B80>
    │   └ <function raise_mysql_exception at 0x0000024D344D3BE0>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to...
          │          └ 1064
          └ <class 'pymysql.err.ProgrammingError'>

sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT ' at line 1")
[SQL: DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT tag from tags;]
(Background on this error at: https://sqlalche.me/e/14/f405)
2023-08-28 23:11:46.675 | SUCCESS  | __main__:mode_a:267 - 数据库一共添加了 0 img data....
2023-08-28 23:11:46.677 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:11:46.702 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:11:46.704 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:11:46.706 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:11:46.708 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:11:46.719 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:11:47.633 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:11:47.704 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:11:47.844 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:11:54.373 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359878
2023-08-28 23:11:54.376 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:11:54.996 | INFO     | cellfunctions_:save_img:242 - 保存图片中......356026
2023-08-28 23:11:55.001 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:12:05.625 | INFO     | cellfunctions_:save_img:242 - 保存图片中......356055
2023-08-28 23:12:05.629 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:12:05.630 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 3 img to IMG_PATH......
2023-08-28 23:12:05.637 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\356026.jpg
2023-08-28 23:12:05.641 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359878.jpg
2023-08-28 23:12:05.644 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\356055.jpg
2023-08-28 23:12:05.680 | ERROR    | __main__:mode_a:265 - An error has been caught in function 'mode_a', process 'MainProcess' (27656), thread 'MainThread' (48776):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000024D19C1FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000024D359815D0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000024D347CA500>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
    │      └ <function Cursor.execute at 0x0000024D3462C0D0>
    └ <pymysql.cursors.Cursor object at 0x0000024D3598DC00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
             │    └ <function Cursor._query at 0x0000024D3462C550>
             └ <pymysql.cursors.Cursor object at 0x0000024D3598DC00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
    │    └ <function Connection.query at 0x0000024D3462F520>
    └ <pymysql.connections.Connection object at 0x0000024D35981930>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x0000024D3462FB50>
    │    │                └ <pymysql.connections.Connection object at 0x0000024D35981930>
    │    └ 48
    └ <pymysql.connections.Connection object at 0x0000024D35981930>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000024D346343A0>
    └ <pymysql.connections.MySQLResult object at 0x0000024D359828C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000024D359828C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x0000024D3462E170>
    └ <pymysql.protocol.MysqlPacket object at 0x0000024D3598D330>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000024D3598D330>
    │   └ <function raise_mysql_exception at 0x0000024D344D3BE0>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to...
          │          └ 1064
          └ <class 'pymysql.err.ProgrammingError'>

pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT ' at line 1")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 326, in <module>
    mode_a()
    └ <function mode_a at 0x0000024D34111E10>

> File "f:\k_grab1.9\main.py", line 265, in mode_a
    save_img_and_todb(pids, engine, kimg_table, tags_table)
    │                 │     │       │           └ 'tags'
    │                 │     │       └ 'kimg'
    │                 │     └ <sqlalchemy.engine.base.Connection object at 0x0000024D347CA500>
    │                 └ [356026, 359878, 356055]
    └ <function save_img_and_todb at 0x0000024D34111AB0>

  File "f:\k_grab1.9\main.py", line 149, in save_img_and_todb
    engine.execute(
    │      └ <function Connection.execute at 0x0000024D19B7A440>
    └ <sqlalchemy.engine.base.Connection object at 0x0000024D347CA500>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           │    │     │            │       └ immutabledict({})
           │    │     │            └ {}
           │    │     └ ()
           │    └ <sqlalchemy.engine.base.Connection object at 0x0000024D347CA500>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.elements.TextClause object at 0x0000024D35983100>>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\sql\elements.py", line 333, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000024D19B7A710>
           └ <sqlalchemy.engine.base.Connection object at 0x0000024D347CA500>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000024D19B7A9E0>
          └ <sqlalchemy.engine.base.Connection object at 0x0000024D347CA500>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000024D19B7AB90>
    └ <sqlalchemy.engine.base.Connection object at 0x0000024D347CA500>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x0000024D1932BAC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1900, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000024D19C1FD90>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000024D359815D0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000024D347CA500>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
    │      └ <function Cursor.execute at 0x0000024D3462C0D0>
    └ <pymysql.cursors.Cursor object at 0x0000024D3598DC00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
             │    └ <function Cursor._query at 0x0000024D3462C550>
             └ <pymysql.cursors.Cursor object at 0x0000024D3598DC00>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ 'DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT ta...
    │    └ <function Connection.query at 0x0000024D3462F520>
    └ <pymysql.connections.Connection object at 0x0000024D35981930>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x0000024D3462FB50>
    │    │                └ <pymysql.connections.Connection object at 0x0000024D35981930>
    │    └ 48
    └ <pymysql.connections.Connection object at 0x0000024D35981930>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000024D346343A0>
    └ <pymysql.connections.MySQLResult object at 0x0000024D359828C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000024D359828C0>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x0000024D3462E170>
    └ <pymysql.protocol.MysqlPacket object at 0x0000024D3598D330>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000024D3598D330>
    │   └ <function raise_mysql_exception at 0x0000024D344D3BE0>
    └ <module 'pymysql.err' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pymysql\\err.py'>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to...
          │          └ 1064
          └ <class 'pymysql.err.ProgrammingError'>

sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT ' at line 1")
[SQL: DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT tag from tags;]
(Background on this error at: https://sqlalche.me/e/14/f405)
2023-08-28 23:12:05.826 | SUCCESS  | __main__:mode_a:267 - 数据库一共添加了 0 img data....
2023-08-28 23:12:05.829 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:12:05.837 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:12:05.839 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:12:05.841 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:12:05.843 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:12:05.852 | INFO     | __main__:mode_a:236 - 数据库共有37条图像数据
2023-08-28 23:12:07.037 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:12:07.385 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:12:07.606 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:12:13.625 | INFO     | cellfunctions_:save_img:242 - 保存图片中......358118
2023-08-28 23:12:13.629 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:12:29.211 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359642
2023-08-28 23:12:29.214 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:16:10.008 | INFO     | __main__:<module>:306 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:16:10.011 | WARNING  | __main__:<module>:319 - 失败,将自动获取headers.......
2023-08-28 23:16:10.559 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:16:10.886 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:16:19.595 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:16:19.635 | SUCCESS  | __main__:<module>:322 - 获取headers成功......
2023-08-28 23:16:19.638 | SUCCESS  | __main__:mode_a:209 - 单次下载数量:3
2023-08-28 23:16:19.639 | SUCCESS  | __main__:mode_a:210 - 并发数:5
2023-08-28 23:16:19.641 | SUCCESS  | __main__:mode_a:211 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:16:19.642 | SUCCESS  | __main__:mode_a:212 - 下载次数:200
2023-08-28 23:16:19.644 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:16:19.901 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:16:19.904 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:16:19.906 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:16:19.908 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:16:19.911 | WARNING  | __main__:mode_a:232 - 无法从kimg找到pid,可能为新表
2023-08-28 23:16:19.913 | INFO     | __main__:mode_a:236 - 数据库共有0条图像数据
2023-08-28 23:16:21.135 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:16:21.914 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:16:22.108 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:16:28.605 | INFO     | cellfunctions_:save_img:242 - 保存图片中......356308
2023-08-28 23:16:28.610 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:16:29.403 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357678
2023-08-28 23:16:29.407 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:16:46.607 | INFO     | cellfunctions_:save_img:242 - 保存图片中......358100
2023-08-28 23:16:46.611 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:16:46.613 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 3 img to IMG_PATH......
2023-08-28 23:16:46.621 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\358100.jpg
2023-08-28 23:16:46.627 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\356308.jpg
2023-08-28 23:16:46.630 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357678.jpg
2023-08-28 23:16:46.686 | ERROR    | __main__:mode_a:265 - An error has been caught in function 'mode_a', process 'MainProcess' (32788), thread 'MainThread' (41424):
Traceback (most recent call last):

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1374, in execute
    meth = statement._execute_on_connection
           └ Text(length='DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT...

AttributeError: 'Text' object has no attribute '_execute_on_connection'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "f:\k_grab1.9\main.py", line 326, in <module>
    mode_a()
    └ <function mode_a at 0x000001B41C901E10>

> File "f:\k_grab1.9\main.py", line 265, in mode_a
    save_img_and_todb(pids, engine, kimg_table, tags_table)
    │                 │     │       │           └ 'tags'
    │                 │     │       └ 'kimg'
    │                 │     └ <sqlalchemy.engine.base.Connection object at 0x000001B41CC8F190>
    │                 └ [358100, 356308, 357678]
    └ <function save_img_and_todb at 0x000001B41C901AB0>

  File "f:\k_grab1.9\main.py", line 149, in save_img_and_todb
    engine.execute(
    │      └ <function Connection.execute at 0x000001B40237A440>
    └ <sqlalchemy.engine.base.Connection object at 0x000001B41CC8F190>

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\engine\base.py", line 1376, in execute
    util.raise_(
    │    └ <function raise_ at 0x000001B401B4BAC0>
    └ <module 'sqlalchemy.util' from 'C:\\Users\\S\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\ut...

  File "C:\Users\S\AppData\Local\Programs\Python\Python310\lib\site-packages\sqlalchemy\util\compat.py", line 208, in raise_
    raise exception

sqlalchemy.exc.ObjectNotExecutableError: Not an executable object: Text(length='DROP TABLE if EXISTS tags_unique;CREATE TABLE if not EXISTS tags_unique LIKE tags;INSERT into tags_unique SELECT DISTINCT tag from tags;')
2023-08-28 23:16:46.738 | SUCCESS  | __main__:mode_a:267 - 数据库一共添加了 0 img data....
2023-08-28 23:16:46.741 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:16:46.760 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:16:46.763 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:16:46.765 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:16:46.766 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:16:46.768 | WARNING  | __main__:mode_a:232 - 无法从kimg找到pid,可能为新表
2023-08-28 23:16:46.770 | INFO     | __main__:mode_a:236 - 数据库共有0条图像数据
2023-08-28 23:16:47.629 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:16:48.683 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:16:48.728 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:16:54.054 | INFO     | cellfunctions_:save_img:242 - 保存图片中......355434
2023-08-28 23:16:54.057 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:23:11.862 | INFO     | __main__:<module>:302 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:23:11.864 | WARNING  | __main__:<module>:315 - 失败,将自动获取headers.......
2023-08-28 23:23:12.404 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:23:12.720 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:23:16.968 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:23:16.998 | SUCCESS  | __main__:<module>:318 - 获取headers成功......
2023-08-28 23:23:16.999 | SUCCESS  | __main__:mode_a:205 - 单次下载数量:1
2023-08-28 23:23:17.000 | SUCCESS  | __main__:mode_a:206 - 并发数:5
2023-08-28 23:23:17.002 | SUCCESS  | __main__:mode_a:207 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:23:17.003 | SUCCESS  | __main__:mode_a:208 - 下载次数:200
2023-08-28 23:23:17.005 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:23:17.102 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:23:17.104 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:23:17.105 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:23:17.107 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:23:17.119 | INFO     | __main__:mode_a:232 - 数据库共有37条图像数据
2023-08-28 23:23:18.261 | WARNING  | cellfunctions_:get_source:152 - 下载源码重试: https://konachan.com/post/show/356818
2023-08-28 23:23:22.959 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:23:29.616 | INFO     | cellfunctions_:save_img:242 - 保存图片中......356818
2023-08-28 23:23:29.618 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:23:29.620 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 1 img to IMG_PATH......
2023-08-28 23:23:29.625 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\356818.jpg
2023-08-28 23:23:33.987 | SUCCESS  | __main__:save_img_and_todb:169 - DataBase had added 1 img data...
2023-08-28 23:23:33.989 | SUCCESS  | __main__:mode_a:263 - 数据库一共添加了 1 img data....
2023-08-28 23:23:33.991 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:23:33.999 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:23:34.001 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:23:34.003 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:23:34.004 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:23:34.013 | INFO     | __main__:mode_a:232 - 数据库共有38条图像数据
2023-08-28 23:23:35.825 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:23:43.393 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357625
2023-08-28 23:23:43.397 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:23:43.398 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 1 img to IMG_PATH......
2023-08-28 23:23:43.401 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357625.jpg
2023-08-28 23:23:48.799 | SUCCESS  | __main__:save_img_and_todb:169 - DataBase had added 1 img data...
2023-08-28 23:23:48.801 | SUCCESS  | __main__:mode_a:263 - 数据库一共添加了 2 img data....
2023-08-28 23:23:48.803 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:23:48.809 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:23:48.811 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:23:48.813 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:23:48.815 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:23:48.821 | INFO     | __main__:mode_a:232 - 数据库共有39条图像数据
2023-08-28 23:23:49.822 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:23:56.723 | INFO     | cellfunctions_:save_img:242 - 保存图片中......355327
2023-08-28 23:23:56.730 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:23:56.731 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 1 img to IMG_PATH......
2023-08-28 23:23:56.736 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\355327.jpg
2023-08-28 23:23:59.153 | SUCCESS  | __main__:save_img_and_todb:169 - DataBase had added 1 img data...
2023-08-28 23:23:59.156 | SUCCESS  | __main__:mode_a:263 - 数据库一共添加了 3 img data....
2023-08-28 23:23:59.158 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:23:59.186 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:23:59.188 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:23:59.190 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:23:59.192 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:23:59.200 | INFO     | __main__:mode_a:232 - 数据库共有40条图像数据
2023-08-28 23:24:00.988 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:39:58.010 | INFO     | __main__:<module>:316 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:39:58.012 | WARNING  | __main__:<module>:329 - 失败,将自动获取headers.......
2023-08-28 23:39:58.550 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:39:58.927 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:40:05.050 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:40:05.092 | SUCCESS  | __main__:<module>:332 - 获取headers成功......
2023-08-28 23:40:05.095 | SUCCESS  | __main__:mode_a:219 - 单次下载数量:1
2023-08-28 23:40:05.096 | SUCCESS  | __main__:mode_a:220 - 并发数:5
2023-08-28 23:40:05.098 | SUCCESS  | __main__:mode_a:221 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:40:05.099 | SUCCESS  | __main__:mode_a:222 - 下载次数:200
2023-08-28 23:40:05.101 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:40:05.243 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:40:05.246 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:40:05.248 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:40:05.249 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:40:05.266 | INFO     | __main__:mode_a:246 - 数据库共有40条图像数据
2023-08-28 23:40:05.268 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:40:05.276 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:40:05.279 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:40:05.282 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:40:05.284 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:40:05.292 | INFO     | __main__:mode_a:246 - 数据库共有40条图像数据
2023-08-28 23:40:06.431 | WARNING  | cellfunctions_:get_source:152 - 下载源码重试: https://konachan.com/post/show/357099
2023-08-28 23:40:11.350 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:40:17.424 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357099
2023-08-28 23:40:17.426 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:40:17.428 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 1 img to IMG_PATH......
2023-08-28 23:40:17.434 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357099.jpg
2023-08-28 23:40:17.479 | INFO     | __main__:save_img_and_todb:151 - 创建一个tags_unique表
2023-08-28 23:40:17.523 | INFO     | __main__:save_img_and_todb:162 - tags 表当前唯一tag数为 : <sqlalchemy.engine.cursor.LegacyCursorResult object at 0x000002B59405B0A0>
2023-08-28 23:40:17.537 | SUCCESS  | __main__:save_img_and_todb:183 - DataBase had added 1 img data...
2023-08-28 23:40:17.540 | SUCCESS  | __main__:mode_a:277 - 数据库一共添加了 1 img data....
2023-08-28 23:40:17.541 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:40:17.550 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:40:17.553 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:40:17.555 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:40:17.557 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:40:17.565 | INFO     | __main__:mode_a:246 - 数据库共有41条图像数据
2023-08-28 23:40:19.357 | ERROR    | cellfunctions_:get_source:136 - 357857图片不存在或者被删除了
2023-08-28 23:40:19.360 | ERROR    | cellfunctions_:get_source:137 - https://konachan.com/post/show/357857/
2023-08-28 23:40:19.364 | WARNING  | __main__:save_img_and_todb:79 - 没有得到数据
2023-08-28 23:40:19.368 | SUCCESS  | __main__:mode_a:277 - 数据库一共添加了 1 img data....
2023-08-28 23:40:19.370 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:40:19.396 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:40:19.396 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:40:19.410 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:40:19.413 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:40:19.421 | INFO     | __main__:mode_a:246 - 数据库共有41条图像数据
2023-08-28 23:40:21.079 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:40:27.220 | INFO     | cellfunctions_:save_img:242 - 保存图片中......356222
2023-08-28 23:40:27.223 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:40:27.225 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 1 img to IMG_PATH......
2023-08-28 23:40:27.230 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\356222.jpg
2023-08-28 23:40:27.241 | INFO     | __main__:save_img_and_todb:151 - 创建一个tags_unique表
2023-08-28 23:40:27.292 | INFO     | __main__:save_img_and_todb:162 - tags 表当前唯一tag数为 : <sqlalchemy.engine.cursor.LegacyCursorResult object at 0x000002B5940B93C0>
2023-08-28 23:40:27.306 | SUCCESS  | __main__:save_img_and_todb:183 - DataBase had added 1 img data...
2023-08-28 23:40:27.310 | SUCCESS  | __main__:mode_a:277 - 数据库一共添加了 2 img data....
2023-08-28 23:40:27.311 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:40:27.322 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:40:27.324 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:40:27.326 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:40:27.327 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:40:27.339 | INFO     | __main__:mode_a:246 - 数据库共有42条图像数据
2023-08-28 23:40:28.576 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:42:58.737 | INFO     | __main__:<module>:318 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:42:58.746 | WARNING  | __main__:<module>:331 - 失败,将自动获取headers.......
2023-08-28 23:42:59.264 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:42:59.603 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:43:04.034 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:43:04.078 | SUCCESS  | __main__:<module>:334 - 获取headers成功......
2023-08-28 23:43:04.081 | SUCCESS  | __main__:mode_a:221 - 单次下载数量:1
2023-08-28 23:43:04.082 | SUCCESS  | __main__:mode_a:222 - 并发数:5
2023-08-28 23:43:04.084 | SUCCESS  | __main__:mode_a:223 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:43:04.085 | SUCCESS  | __main__:mode_a:224 - 下载次数:200
2023-08-28 23:43:04.086 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:43:04.315 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:43:04.317 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:43:04.319 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:43:04.320 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:43:04.337 | INFO     | __main__:mode_a:248 - 数据库共有42条图像数据
2023-08-28 23:43:05.498 | WARNING  | cellfunctions_:get_source:152 - 下载源码重试: https://konachan.com/post/show/359893
2023-08-28 23:43:07.564 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:43:13.317 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359893
2023-08-28 23:43:13.320 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:43:13.322 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 1 img to IMG_PATH......
2023-08-28 23:43:13.327 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359893.jpg
2023-08-28 23:43:13.369 | INFO     | __main__:save_img_and_todb:151 - 创建一个tags_unique表
2023-08-28 23:43:13.405 | INFO     | __main__:save_img_and_todb:164 - tags 表当前唯一tag数为 : (409,)
2023-08-28 23:43:13.416 | SUCCESS  | __main__:save_img_and_todb:185 - DataBase had added 1 img data...
2023-08-28 23:43:13.418 | SUCCESS  | __main__:mode_a:279 - 数据库一共添加了 1 img data....
2023-08-28 23:43:13.420 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:43:13.426 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:43:13.428 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:43:13.430 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:43:13.431 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:43:13.437 | INFO     | __main__:mode_a:248 - 数据库共有43条图像数据
2023-08-28 23:43:14.956 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:43:21.139 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357648
2023-08-28 23:43:21.142 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:43:21.143 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 1 img to IMG_PATH......
2023-08-28 23:43:21.148 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357648.jpg
2023-08-28 23:43:21.182 | INFO     | __main__:save_img_and_todb:151 - 创建一个tags_unique表
2023-08-28 23:43:21.226 | INFO     | __main__:save_img_and_todb:164 - tags 表当前唯一tag数为 : (417,)
2023-08-28 23:43:21.241 | SUCCESS  | __main__:save_img_and_todb:185 - DataBase had added 1 img data...
2023-08-28 23:43:21.244 | SUCCESS  | __main__:mode_a:279 - 数据库一共添加了 2 img data....
2023-08-28 23:43:21.246 | INFO     | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:43:21.255 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:43:21.257 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:43:21.259 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:43:21.260 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:43:21.269 | INFO     | __main__:mode_a:248 - 数据库共有44条图像数据
2023-08-28 23:43:22.221 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:45:45.341 | DEBUG    | __main__:<module>:318 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:45:45.346 | WARNING  | __main__:<module>:331 - 失败,将用函数get_headers()采用playwright无头模式下自动获取headers.......
2023-08-28 23:45:45.887 | INFO     | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:45:46.222 | INFO     | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:45:52.521 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:45:52.551 | SUCCESS  | __main__:<module>:336 - 获取headers成功......
2023-08-28 23:45:52.553 | SUCCESS  | __main__:mode_a:221 - 单次下载数量:1
2023-08-28 23:45:52.555 | SUCCESS  | __main__:mode_a:222 - 并发数:5
2023-08-28 23:45:52.556 | SUCCESS  | __main__:mode_a:223 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:45:52.558 | SUCCESS  | __main__:mode_a:224 - 下载次数:200
2023-08-28 23:45:52.559 | DEBUG    | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:45:52.686 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:45:52.689 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:45:52.690 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:45:52.692 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:45:52.709 | INFO     | __main__:mode_a:248 - 数据库共有44条图像数据
2023-08-28 23:45:53.916 | WARNING  | cellfunctions_:get_source:152 - 下载源码重试: https://konachan.com/post/show/361816
2023-08-28 23:45:56.170 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:46:01.888 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361816
2023-08-28 23:46:01.890 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:46:01.892 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 1 img to IMG_PATH......
2023-08-28 23:46:01.896 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\361816.jpg
2023-08-28 23:46:01.924 | DEBUG    | __main__:save_img_and_todb:151 - 创建一个tags_unique表
2023-08-28 23:46:01.961 | INFO     | __main__:save_img_and_todb:164 - tags 表当前唯一tag数为 : (420,)
2023-08-28 23:46:01.972 | SUCCESS  | __main__:save_img_and_todb:185 - DataBase had added 1 img data...
2023-08-28 23:46:01.974 | SUCCESS  | __main__:mode_a:279 - 数据库一共添加了 1 img data....
2023-08-28 23:46:01.975 | DEBUG    | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:46:01.993 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:46:01.995 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:46:01.997 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:46:01.999 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:46:02.006 | INFO     | __main__:mode_a:248 - 数据库共有45条图像数据
2023-08-28 23:46:03.312 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:08.610 | DEBUG    | __main__:<module>:318 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:47:08.612 | WARNING  | __main__:<module>:331 - 失败,将用函数get_headers()采用playwright无头模式下自动获取headers.......
2023-08-28 23:47:09.132 | DEBUG    | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:47:09.512 | DEBUG    | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:47:14.520 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:47:14.563 | SUCCESS  | __main__:<module>:336 - 获取headers成功......
2023-08-28 23:47:14.565 | SUCCESS  | __main__:mode_a:221 - 单次下载数量:3
2023-08-28 23:47:14.566 | SUCCESS  | __main__:mode_a:222 - 并发数:5
2023-08-28 23:47:14.568 | SUCCESS  | __main__:mode_a:223 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:47:14.570 | SUCCESS  | __main__:mode_a:224 - 下载次数:200
2023-08-28 23:47:14.573 | DEBUG    | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:47:14.783 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:47:14.785 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:47:14.787 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:47:14.788 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:47:14.806 | INFO     | __main__:mode_a:248 - 数据库共有45条图像数据
2023-08-28 23:47:16.091 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:16.278 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:18.205 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:24.380 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359510
2023-08-28 23:47:24.383 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:47:25.877 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357529
2023-08-28 23:47:25.883 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:47:30.720 | INFO     | cellfunctions_:save_img:242 - 保存图片中......360537
2023-08-28 23:47:30.723 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:47:30.726 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 3 img to IMG_PATH......
2023-08-28 23:47:30.732 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\360537.jpg
2023-08-28 23:47:30.737 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357529.jpg
2023-08-28 23:47:30.745 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359510.jpg
2023-08-28 23:47:30.785 | DEBUG    | __main__:save_img_and_todb:151 - 创建一个tags_unique表
2023-08-28 23:47:30.826 | INFO     | __main__:save_img_and_todb:164 - tags 表当前唯一tag数为 : (428,)
2023-08-28 23:47:30.838 | SUCCESS  | __main__:save_img_and_todb:185 - DataBase had added 3 img data...
2023-08-28 23:47:30.840 | SUCCESS  | __main__:mode_a:279 - 数据库一共添加了 3 img data....
2023-08-28 23:47:30.842 | DEBUG    | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:47:30.865 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:47:30.867 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:47:30.869 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:47:30.874 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:47:30.882 | INFO     | __main__:mode_a:248 - 数据库共有48条图像数据
2023-08-28 23:47:32.209 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:32.408 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:33.029 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:40.638 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359990
2023-08-28 23:47:40.640 | INFO     | cellfunctions_:save_img:242 - 保存图片中......357036
2023-08-28 23:47:40.643 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:47:40.645 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:47:42.291 | INFO     | cellfunctions_:save_img:242 - 保存图片中......359861
2023-08-28 23:47:42.294 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:47:42.295 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 3 img to IMG_PATH......
2023-08-28 23:47:42.300 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\357036.jpg
2023-08-28 23:47:42.304 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359861.jpg
2023-08-28 23:47:42.308 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359990.jpg
2023-08-28 23:47:42.337 | DEBUG    | __main__:save_img_and_todb:151 - 创建一个tags_unique表
2023-08-28 23:47:42.375 | INFO     | __main__:save_img_and_todb:164 - tags 表当前唯一tag数为 : (439,)
2023-08-28 23:47:42.391 | SUCCESS  | __main__:save_img_and_todb:185 - DataBase had added 3 img data...
2023-08-28 23:47:42.393 | SUCCESS  | __main__:mode_a:279 - 数据库一共添加了 6 img data....
2023-08-28 23:47:42.394 | DEBUG    | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:47:42.401 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:47:42.403 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:47:42.405 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:47:42.407 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:47:42.428 | INFO     | __main__:mode_a:248 - 数据库共有51条图像数据
2023-08-28 23:47:43.415 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:43.547 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:44.131 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:47:52.133 | INFO     | cellfunctions_:save_img:242 - 保存图片中......361154
2023-08-28 23:47:52.136 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:47:57.675 | INFO     | cellfunctions_:save_img:242 - 保存图片中......355028
2023-08-28 23:47:57.678 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:48:36.378 | DEBUG    | __main__:<module>:318 - 尝试从headers_firefox.json获取headers.......
2023-08-28 23:48:36.379 | WARNING  | __main__:<module>:331 - 失败,将用函数get_headers()采用playwright无头模式下自动获取headers.......
2023-08-28 23:48:36.961 | DEBUG    | cellfunctions_:get_headers:66 - 利用playwright获取cookie及headers......
2023-08-28 23:48:37.341 | DEBUG    | cellfunctions_:get_headers:71 - 启动浏览器上下文....
2023-08-28 23:48:44.015 | SUCCESS  | cellfunctions_:get_headers:112 - 获取cookie及headers成功
2023-08-28 23:48:44.049 | SUCCESS  | __main__:<module>:336 - 获取headers成功......
2023-08-28 23:48:44.051 | SUCCESS  | __main__:mode_a:221 - 单次下载数量:3
2023-08-28 23:48:44.052 | SUCCESS  | __main__:mode_a:222 - 并发数:5
2023-08-28 23:48:44.054 | SUCCESS  | __main__:mode_a:223 - 下载图片路径:F:\database_learn\k_spider\pictures10
2023-08-28 23:48:44.055 | SUCCESS  | __main__:mode_a:224 - 下载次数:200
2023-08-28 23:48:44.057 | DEBUG    | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:48:44.168 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:48:44.170 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:48:44.171 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:48:44.173 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:48:44.189 | INFO     | __main__:mode_a:248 - 数据库共有51条图像数据
2023-08-28 23:48:45.538 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:48:45.571 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:48:47.843 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:48:53.651 | DEBUG    | cellfunctions_:save_img:242 - 保存图片中......360821
2023-08-28 23:48:53.653 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:48:54.712 | DEBUG    | cellfunctions_:save_img:242 - 保存图片中......359602
2023-08-28 23:48:54.717 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:48:58.499 | DEBUG    | cellfunctions_:save_img:242 - 保存图片中......359837
2023-08-28 23:48:58.502 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:48:58.504 | SUCCESS  | get_imags_data:download_imgs:121 - downloaded 3 img to IMG_PATH......
2023-08-28 23:48:58.511 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359602.jpg
2023-08-28 23:48:58.517 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\359837.jpg
2023-08-28 23:48:58.520 | SUCCESS  | __main__:save_img_and_todb:108 - imported: F:\database_learn\k_spider\pictures10\360821.jpg
2023-08-28 23:48:58.578 | DEBUG    | __main__:save_img_and_todb:151 - 创建一个tags_unique表
2023-08-28 23:48:58.620 | INFO     | __main__:save_img_and_todb:164 - tags 表当前唯一tag数为 : (447,)
2023-08-28 23:48:58.634 | SUCCESS  | __main__:save_img_and_todb:185 - DataBase had added 3 img data...
2023-08-28 23:48:58.636 | SUCCESS  | __main__:mode_a:279 - 数据库一共添加了 3 img data....
2023-08-28 23:48:58.638 | DEBUG    | __main__:link_db:25 - 连接数据库中...........
2023-08-28 23:48:58.658 | SUCCESS  | __main__:link_db:48 - 数据表: testdb
2023-08-28 23:48:58.660 | SUCCESS  | __main__:link_db:49 - 图像数据表: kimg
2023-08-28 23:48:58.661 | SUCCESS  | __main__:link_db:50 - tag数据表: tags
2023-08-28 23:48:58.663 | SUCCESS  | __main__:link_db:52 - link dbas 准备导入数据.....
2023-08-28 23:48:58.669 | INFO     | __main__:mode_a:248 - 数据库共有54条图像数据
2023-08-28 23:48:59.893 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:48:59.897 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:49:00.251 | SUCCESS  | cellfunctions_:get_source:148 - 获取源码成功
2023-08-28 23:49:05.757 | DEBUG    | cellfunctions_:save_img:242 - 保存图片中......360499
2023-08-28 23:49:05.760 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
2023-08-28 23:49:07.146 | DEBUG    | cellfunctions_:save_img:242 - 保存图片中......359317
2023-08-28 23:49:07.148 | SUCCESS  | cellfunctions_:save_img:245 - 下载图片成功
